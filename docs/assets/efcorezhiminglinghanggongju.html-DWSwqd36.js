import{_ as o}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as i,o as c,c as l,a,d as e,e as s,b as t}from"./app-Bw62I61B.js";const r="/kbms/common/1621691682147-40e2c2d3-c8a8-4539-ae1a-119050ddd46c.png",p="/kbms/common/1621691745639-9f4882dc-2b14-4f6f-86f8-b367bda17085.png",d="/kbms/common/1621692104322-fcea5b1e-6627-4be8-8454-f9e8d98cf162.png",u="/kbms/common/1621693379678-d416ee07-bbc4-482c-bc64-fe5e57f349b4.png",m="/kbms/common/1621693420142-8822ffa1-04d8-417c-b845-06f6147096ad.png",g="/kbms/common/1621695517264-5809009b-0db9-4f65-8888-78152060689c.png",h="/kbms/common/1621696179270-cf4c9c05-59be-4a83-9103-95a21aa63e7e.png",b="/kbms/common/1621693765298-d5a13bd3-2b42-49ba-867e-8f5474433585.png",k="/kbms/common/1621697557205-ffa777d4-8429-4ca7-9573-a4cb3e68438e.png",v="/kbms/common/1621697542283-e77da708-4def-4fee-be11-496a3cdc26a8.png",f="/kbms/common/1621697623587-c3232f61-36a4-452e-84e3-7789a9a50caa.png",x="/kbms/common/1621698024441-3e8887bb-a239-433a-9b75-231528fca8e0.png",C="/kbms/common/1621698058297-5a7e56b2-5a58-4bff-90cb-b7e8f1daedc0.png",_={},q=a("h2",{id:"介绍",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#介绍"},[a("span",null,"介绍")])],-1),y=a("p",null,'EFCore工具可帮助完成设计数据库时候的开发任务，主要用于通过对数据库架构进行反向工程来管理迁移和搭建DbContext和实体类型。EFCore .NET命令行工具是对跨平台.NET Core CLI工具的扩展，该工具执行需要具有.NET Core SDK(具有 Sdk="Microsoft.NET.Sdk" 的项目或项目文件中的相似项目)的项目，优点是适用于所有平台。',-1),z=a("h2",{id:"安装工具",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#安装工具"},[a("span",null,"安装工具")])],-1),E={href:"https://docs.microsoft.com/zh-cn/windows/terminal/",target:"_blank",rel:"noopener noreferrer"},D=t(`<div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token preprocessor property">## 安装为全局工具</span>
dotnet tool install <span class="token operator">--</span><span class="token keyword">global</span> dotnet<span class="token operator">-</span>ef

<span class="token preprocessor property">## 更新工具</span>
dotnet tool update <span class="token operator">--</span><span class="token keyword">global</span> dotnet<span class="token operator">-</span>ef
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+r+`" alt="image.png" loading="lazy"> 验证安装</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>dotnet ef
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,3),S=a("img",{src:p,alt:"image.png",loading:"lazy"},null,-1),A={href:"https://docs.microsoft.com/zh-cn/ef/core/cli/dotnet",target:"_blank",rel:"noopener noreferrer"},T=a("h2",{id:"创建项目",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#创建项目"},[a("span",null,"创建项目")])],-1),N=a("p",null,[e("本次使用的项目为.NetCore WebAPI项目，代码结构如下 "),a("img",{src:d,alt:"image.png",loading:"lazy"})],-1),w={href:"https://gitee.com/AZRNG/my-example",target:"_blank",rel:"noopener noreferrer"},M=t(`<h2 id="迁移代码优先" tabindex="-1"><a class="header-anchor" href="#迁移代码优先"><span>迁移代码优先</span></a></h2><ul><li>-o 是指定迁移文件的输出目录。</li><li>-c 是指定要用于迁移的 DbContext 类型</li><li>-s 是指定项目的启动项（startup project）的路径</li><li>-v 是用于显示详细的命令执行信息，包括生成的 SQL 语句和执行过程等。</li></ul><h3 id="简单迁移" tabindex="-1"><a class="header-anchor" href="#简单迁移"><span>简单迁移</span></a></h3><p>使用迁移还需要另外安装Nuget包，该包包含 EF Core 用于创建数据库的所有设计逻辑。</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token operator">&lt;</span><span class="token class-name">PackageReference</span> Include<span class="token operator">=</span><span class="token string">&quot;Microsoft.EntityFrameworkCore.Design&quot;</span> Version<span class="token operator">=</span><span class="token string">&quot;5.0.6&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在项目文件夹目录下操作终端工具</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>dotnet ef migrations <span class="token keyword">add</span> Init

<span class="token comment">//  指定Migrations目录</span>
dotnet ef migrations <span class="token keyword">add</span> Init <span class="token operator">--</span>output<span class="token operator">-</span>dir MyMigration

<span class="token comment">// 指定迁移上下文</span>
dotnet ef migrations <span class="token keyword">add</span> Init <span class="token operator">--</span>context BlogContext
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>在 EF Core 5.0及以上 中，才可以使用更改独立于目录的命名空间 --namespace 。</p></blockquote><p>此处Init为迁移名称，该名称要可以表示出当前迁移的内容信息。 <img src="`+u+'" alt="image.png" loading="lazy"> 生成成功，查看项目内的变化，增加了一个文件夹Migrations <img src="'+m+`" alt="image.png" loading="lazy"> xxxxxx_Init -主迁移文件。包含应用迁移的操作(在up中)和还原迁移所需的操作(在down中) OpenDbContextModelSnapshot -当前模型的快照。用于确定添加下一迁移时的更改内容。</p><blockquote><p>最好检查下生成的内容是不是我们期望的那样子，有些情况下是需要进行修改的。</p></blockquote><p>如果这个时候，我们又修改了实体类，那么还可以运行命令再次迁移(迁移名称不能相同)</p><h3 id="更多迁移参数" tabindex="-1"><a class="header-anchor" href="#更多迁移参数"><span>更多迁移参数</span></a></h3><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>dotnet ef migrations <span class="token keyword">add</span> <span class="token string">&quot;1.2.0&quot;</span> <span class="token operator">-</span>o <span class="token string">&quot;../Admin.Api.EntityframeworkCore/Migrations&quot;</span> <span class="token operator">-</span>c  Admin<span class="token punctuation">.</span>Api<span class="token punctuation">.</span>EntityframeworkCore<span class="token punctuation">.</span>MetaDataDbContext <span class="token operator">-</span>s <span class="token string">&quot;../Admin.Api.Service&quot;</span> <span class="token operator">-</span>v
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>&quot;1.2.0&quot; 是指定迁移的名称，这里是 &quot;1.2.0&quot;。</li><li>-o &quot;../Admin.Api.EntityframeworkCore/Migrations&quot; 是指定迁移文件的输出目录，这里是 &quot;../Admin.Api.EntityframeworkCore/Migrations&quot;。</li><li>-c Admin.Api.EntityframeworkCore.MetaDataDbContext 是指定要用于迁移的 DbContext 类型，这里是 &quot;Admin.Api.EntityframeworkCore.MetaDataDbContext&quot;。</li><li>-s &quot;../Admin.Api.Service&quot; 是指定项目的启动项（startup project）的路径，这里是 &quot;../Admin.Api.Service&quot;。</li><li>-v 是用于显示详细的命令执行信息，包括生成的 SQL 语句和执行过程等。</li></ul><h3 id="特殊情况" tabindex="-1"><a class="header-anchor" href="#特殊情况"><span>特殊情况</span></a></h3><p>有些特殊情况下生成的迁移文件不是我们预期的那样子，这个时候需要手动修改。</p><h4 id="列名重命名" tabindex="-1"><a class="header-anchor" href="#列名重命名"><span>列名重命名</span></a></h4><p>如果实体类中的列明重复了，我们重新迁移，查看生成的文件，比如我将用户表Account修改为UserName，按照官网的说法会生成一下迁移</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>migrationBuilder<span class="token punctuation">.</span><span class="token function">DropColumn</span><span class="token punctuation">(</span>
    <span class="token named-parameter punctuation">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Account&quot;</span><span class="token punctuation">,</span>
    <span class="token named-parameter punctuation">table</span><span class="token punctuation">:</span> <span class="token string">&quot;User&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

migrationBuilder<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddColumn</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>
    <span class="token named-parameter punctuation">name</span><span class="token punctuation">:</span> <span class="token string">&quot;UserName&quot;</span><span class="token punctuation">,</span>
    <span class="token named-parameter punctuation">table</span><span class="token punctuation">:</span> <span class="token string">&quot;User&quot;</span><span class="token punctuation">,</span>
    <span class="token named-parameter punctuation">nullable</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>实际生成结果为</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>    migrationBuilder<span class="token punctuation">.</span><span class="token function">RenameColumn</span><span class="token punctuation">(</span>
        <span class="token named-parameter punctuation">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Account&quot;</span><span class="token punctuation">,</span>
        <span class="token named-parameter punctuation">table</span><span class="token punctuation">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
        <span class="token named-parameter punctuation">newName</span><span class="token punctuation">:</span> <span class="token string">&quot;UserName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果生成了先Drop再Add那种进行应用数据库，则用户的帐号都会丢失，所以需要修改我下面这种。(当前现在生成的就是我们想要样子，不过我们还需要谨慎)</p>`,22),F={href:"https://docs.microsoft.com/zh-cn/ef/core/managing-schemas/migrations/managing?tabs=dotnet-core-cli",target:"_blank",rel:"noopener noreferrer"},I=t(`<h3 id="删除迁移" tabindex="-1"><a class="header-anchor" href="#删除迁移"><span>删除迁移</span></a></h3><p>有时候我们在添加迁移后，马上有实体进行改动，这个时候我们并不像再次生成迁移，那么就可以考虑删除上个迁移。</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>dotnet ef migrations <span class="token keyword">remove</span>

dotnet ef migrations <span class="token keyword">remove</span>  <span class="token operator">-</span>c  OspDbContext <span class="token operator">-</span>s <span class="token string">&quot;../Admin.Api.Service&quot;</span>    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>删除迁移后，对实体进行更改，然后再次添加迁移。特殊情况下我们想删除所有的迁移，可以通过删除迁移文件夹并删除数据库来完成。 场景：我们已经生成了许多迁移文件，比较繁琐，我们想将这些迁移文件合并，那么就可以删除迁移文件夹，然后删除数据库的迁移历史表数据，再次生成迁移，根据生成的迁移名称，对迁移历史记录表增加一条对应的数据。</p><h3 id="列出迁移" tabindex="-1"><a class="header-anchor" href="#列出迁移"><span>列出迁移</span></a></h3><p>通过下面命令可以查询到我们所有的迁移</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>dotnet ef migrations list
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="`+g+`" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="生成sql脚本" tabindex="-1"><a class="header-anchor" href="#生成sql脚本"><span>生成SQL脚本</span></a></h3><h4 id="生成从0到最新迁移的sql脚本" tabindex="-1"><a class="header-anchor" href="#生成从0到最新迁移的sql脚本"><span>生成从0到最新迁移的SQL脚本</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>dotnet ef migrations script
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="`+h+`" alt="image.png" loading="lazy"> 更多参数</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>dotnet ef migrations script <span class="token operator">-</span>c  OspDbContext <span class="token operator">-</span>s <span class="token string">&quot;../Admin.Api.Service&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在上下文所在程序集下执行</p><h4 id="from" tabindex="-1"><a class="header-anchor" href="#from"><span>From</span></a></h4><p>生成从给定迁移到最新迁移的SQL脚本（包含最新迁移）</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>dotnet ef migrations script AddNewTables
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="from和to" tabindex="-1"><a class="header-anchor" href="#from和to"><span>From和To</span></a></h4><p>可以从指定的From迁移到指定迁移To的SQL脚本</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>dotnet ef migrations script AddNewTables AddAuditTable
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>脚本生成接受以下两个参数，以指示应生成的迁移范围：</p><ul><li>from 迁移应是运行该脚本前应用到数据库的最后一个迁移。 如果未应用任何迁移，请指定 <code>0</code>（默认值）。</li><li>to 迁移是运行该脚本后应用到数据库的最后一个迁移。 它默认为项目中的最后一个迁移。</li></ul><h2 id="创建数据库和表" tabindex="-1"><a class="header-anchor" href="#创建数据库和表"><span>创建数据库和表</span></a></h2><h3 id="手动执行" tabindex="-1"><a class="header-anchor" href="#手动执行"><span>手动执行</span></a></h3><p>让EFCore创建数据库并从迁移中创建表结构，运行命令</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>dotnet ef database update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="`+b+`" alt="image.png" loading="lazy"> 如果后续我们实体类结构再有修改，那么还可以先创建迁移文件，然后再生成到数据库。(因为EF已经检测到数据库已存在，会通过对比特殊迁移历史记录表，然后只应用那些新的迁移)。</p><h3 id="更多参数" tabindex="-1"><a class="header-anchor" href="#更多参数"><span>更多参数</span></a></h3><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>dotnet ef database update <span class="token operator">-</span>c MetaDataDbContext <span class="token operator">-</span>s <span class="token string">&quot;../xxx.Service&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在上下文所在程序集下执行</p><h3 id="运行时候执行" tabindex="-1"><a class="header-anchor" href="#运行时候执行"><span>运行时候执行</span></a></h3><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token comment">//如果当前数据库不存在按照当前 model 创建，如果存在则将数据库调整到和当前 model 匹配</span>
dbContext<span class="token punctuation">.</span>Database<span class="token punctuation">.</span><span class="token function">Migrate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 生产环境使用考虑好数据问题</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>请勿在 Migrate() 前调用 EnsureCreated()。 EnsureCreated() 会绕过迁移创建架构，这会导致 Migrate() 失败</p></blockquote><h2 id="创建和删除api" tabindex="-1"><a class="header-anchor" href="#创建和删除api"><span>创建和删除API</span></a></h2><h3 id="ensuredeleted" tabindex="-1"><a class="header-anchor" href="#ensuredeleted"><span>EnsureDeleted</span></a></h3><p>EnsureDeleted 方法会删除数据库（如果存在）。 如果你没有相应的权限，则会引发异常。</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token comment">// Drop the database if it exists</span>
dbContext<span class="token punctuation">.</span>Database<span class="token punctuation">.</span><span class="token function">EnsureDeleted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ensurecreated" tabindex="-1"><a class="header-anchor" href="#ensurecreated"><span>EnsureCreated</span></a></h3><p>如果数据库不存在，EnsureCreated 将创建数据库并初始化数据库架构。 如果存在任何表 (包括其他 DbContext 类) 的表，则不会初始化该架构。</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token comment">// Create the database if it doesn&#39;t exist</span>
dbContext<span class="token punctuation">.</span>Database<span class="token punctuation">.</span><span class="token function">EnsureCreated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="sql-脚本" tabindex="-1"><a class="header-anchor" href="#sql-脚本"><span>SQL 脚本</span></a></h3><p>若要获取 EnsureCreated 使用的 SQL，可以使用 GenerateCreateScript 方法。</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> sql <span class="token operator">=</span> dbContext<span class="token punctuation">.</span>Database<span class="token punctuation">.</span><span class="token function">GenerateCreateScript</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="多个-dbcontext-类" tabindex="-1"><a class="header-anchor" href="#多个-dbcontext-类"><span>多个 DbContext 类</span></a></h3><p>EnsureCreated 仅在数据库中不存在任何表时有效。 如果需要，您可以编写自己的检查来查看是否需要初始化架构，并使用基础 IRelationalDatabaseCreator 服务来初始化架构。</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token comment">// TODO: Check whether the schema needs to be initialized</span>

<span class="token comment">// Initialize the schema for this DbContext</span>
<span class="token class-name"><span class="token keyword">var</span></span> databaseCreator <span class="token operator">=</span> dbContext<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetService</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IRelationalDatabaseCreator<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
databaseCreator<span class="token punctuation">.</span><span class="token function">CreateTables</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,46),L={href:"https://docs.microsoft.com/zh-cn/ef/core/managing-schemas/ensure-created",target:"_blank",rel:"noopener noreferrer"},j=t(`<h2 id="反向工程数据库优先" tabindex="-1"><a class="header-anchor" href="#反向工程数据库优先"><span>反向工程数据库优先</span></a></h2><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>dotnet ef dbcontext scaffold <span class="token string">&quot;Data Source=(localdb)\\MSSQLLocalDB;Initial Catalog=Chinook&quot;</span> Microsoft<span class="token punctuation">.</span>EntityFrameworkCore<span class="token punctuation">.</span>SqlServer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>配置数据库连接字符串、数据库提供程序</p><blockquote><p>常用配置 --table 指定表反向工程，多个表加多个--table --context  指定上下文 -context-dir 指定上下文目录 --output-dir Models 指定上下文目录</p></blockquote><p>示例：当前我们有一个数据库文件，需要通过反向工程生成实体类，表结构如下 user <img src="`+k+'" alt="image.png" loading="lazy"> score <img src="'+v+'" alt="image.png" loading="lazy"> 项目结构如下 <img src="'+f+`" alt="image.png" loading="lazy"> 项目目录使用终端执行命令</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>dotnet ef dbcontext scaffold <span class="token string">&quot;Server=localhost;Database=test;Port=3306;charset=utf8;uid=root;pwd=123456;&quot;</span> Pomelo<span class="token punctuation">.</span>EntityFrameworkCore<span class="token punctuation">.</span>MySql <span class="token operator">--</span>output<span class="token operator">-</span>dir Entity  <span class="token operator">--</span>context OpenDbContext
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="`+x+'" alt="image.png" loading="lazy"> 项目结构如下 <img src="'+C+'" alt="image.png" loading="lazy"></p><blockquote><p>不过反向工程这种并不会将数据库表注释带到代码中，并且每次执行时候会删除原来的表结构。</p></blockquote><h2 id="参考文档" tabindex="-1"><a class="header-anchor" href="#参考文档"><span>参考文档</span></a></h2>',9),Q={href:"https://docs.microsoft.com/zh-cn/ef/core/managing-schemas/migrations/managing?tabs=dotnet-core-cli",target:"_blank",rel:"noopener noreferrer"},P={href:"https://docs.microsoft.com/zh-cn/ef/core/managing-schemas/migrations/history-table",target:"_blank",rel:"noopener noreferrer"};function B(O,Z){const n=i("ExternalLinkIcon");return c(),l("div",null,[q,y,z,a("p",null,[e("使用终端工具执行在任意目录执行下面命令，可以尝试下"),a("a",E,[e("Terminal"),s(n)]),e("终端工具。")]),D,a("p",null,[S,e(" 参考地址："),a("a",A,[e("https://docs.microsoft.com/zh-cn/ef/core/cli/dotnet"),s(n)])]),T,N,a("blockquote",null,[a("p",null,[e("源代码地址："),a("a",w,[e("https://gitee.com/AZRNG/my-example"),s(n)])])]),M,a("p",null,[e("还有其他的情况需要注意，可以参考"),a("a",F,[e("官网"),s(n)])]),I,a("blockquote",null,[a("p",null,[e("参考地址："),a("a",L,[e("https://docs.microsoft.com/zh-cn/ef/core/managing-schemas/ensure-created"),s(n)])])]),j,a("blockquote",null,[a("p",null,[e("开始迁移："),a("a",Q,[e("https://docs.microsoft.com/zh-cn/ef/core/managing-schemas/migrations/managing?tabs=dotnet-core-cli"),s(n)]),e(" 自定义历史记录表："),a("a",P,[e("https://docs.microsoft.com/zh-cn/ef/core/managing-schemas/migrations/history-table"),s(n)])])])])}const U=o(_,[["render",B],["__file","efcorezhiminglinghanggongju.html.vue"]]),V=JSON.parse('{"path":"/orm/efcore/qianyishuju/efcorezhiminglinghanggongju.html","title":"EFCore之命令行工具","lang":"zh-CN","frontmatter":{"title":"EFCore之命令行工具","lang":"zh-CN","date":"2023-07-03T00:00:00.000Z","publish":true,"author":"azrng","isOriginal":true,"category":["orm"],"tag":["无"],"filename":"efcorezhiminglinghanggongju","slug":"nlzu47","docsId":"45771699","description":"介绍 EFCore工具可帮助完成设计数据库时候的开发任务，主要用于通过对数据库架构进行反向工程来管理迁移和搭建DbContext和实体类型。EFCore .NET命令行工具是对跨平台.NET Core CLI工具的扩展，该工具执行需要具有.NET Core SDK(具有 Sdk=\\"Microsoft.NET.Sdk\\" 的项目或项目文件中的相似项目)的项...","head":[["meta",{"property":"og:url","content":"https://azrng.gitee.io/kbms/kbms/orm/efcore/qianyishuju/efcorezhiminglinghanggongju.html"}],["meta",{"property":"og:site_name","content":"知识库"}],["meta",{"property":"og:title","content":"EFCore之命令行工具"}],["meta",{"property":"og:description","content":"介绍 EFCore工具可帮助完成设计数据库时候的开发任务，主要用于通过对数据库架构进行反向工程来管理迁移和搭建DbContext和实体类型。EFCore .NET命令行工具是对跨平台.NET Core CLI工具的扩展，该工具执行需要具有.NET Core SDK(具有 Sdk=\\"Microsoft.NET.Sdk\\" 的项目或项目文件中的相似项目)的项..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://azrng.gitee.io/kbms/kbms/common/1621691682147-40e2c2d3-c8a8-4539-ae1a-119050ddd46c.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-07-23T07:36:52.000Z"}],["meta",{"property":"article:author","content":"azrng"}],["meta",{"property":"article:tag","content":"无"}],["meta",{"property":"article:published_time","content":"2023-07-03T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-07-23T07:36:52.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"EFCore之命令行工具\\",\\"image\\":[\\"https://azrng.gitee.io/kbms/kbms/common/1621691682147-40e2c2d3-c8a8-4539-ae1a-119050ddd46c.png\\",\\"https://azrng.gitee.io/kbms/kbms/common/1621691745639-9f4882dc-2b14-4f6f-86f8-b367bda17085.png\\",\\"https://azrng.gitee.io/kbms/kbms/common/1621692104322-fcea5b1e-6627-4be8-8454-f9e8d98cf162.png\\",\\"https://azrng.gitee.io/kbms/kbms/common/1621693379678-d416ee07-bbc4-482c-bc64-fe5e57f349b4.png\\",\\"https://azrng.gitee.io/kbms/kbms/common/1621693420142-8822ffa1-04d8-417c-b845-06f6147096ad.png\\",\\"https://azrng.gitee.io/kbms/kbms/common/1621695517264-5809009b-0db9-4f65-8888-78152060689c.png\\",\\"https://azrng.gitee.io/kbms/kbms/common/1621696179270-cf4c9c05-59be-4a83-9103-95a21aa63e7e.png\\",\\"https://azrng.gitee.io/kbms/kbms/common/1621693765298-d5a13bd3-2b42-49ba-867e-8f5474433585.png\\",\\"https://azrng.gitee.io/kbms/kbms/common/1621697557205-ffa777d4-8429-4ca7-9573-a4cb3e68438e.png\\",\\"https://azrng.gitee.io/kbms/kbms/common/1621697542283-e77da708-4def-4fee-be11-496a3cdc26a8.png\\",\\"https://azrng.gitee.io/kbms/kbms/common/1621697623587-c3232f61-36a4-452e-84e3-7789a9a50caa.png\\",\\"https://azrng.gitee.io/kbms/kbms/common/1621698024441-3e8887bb-a239-433a-9b75-231528fca8e0.png\\",\\"https://azrng.gitee.io/kbms/kbms/common/1621698058297-5a7e56b2-5a58-4bff-90cb-b7e8f1daedc0.png\\"],\\"datePublished\\":\\"2023-07-03T00:00:00.000Z\\",\\"dateModified\\":\\"2023-07-23T07:36:52.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"azrng\\"}]}"]]},"headers":[{"level":2,"title":"介绍","slug":"介绍","link":"#介绍","children":[]},{"level":2,"title":"安装工具","slug":"安装工具","link":"#安装工具","children":[]},{"level":2,"title":"创建项目","slug":"创建项目","link":"#创建项目","children":[]},{"level":2,"title":"迁移代码优先","slug":"迁移代码优先","link":"#迁移代码优先","children":[{"level":3,"title":"简单迁移","slug":"简单迁移","link":"#简单迁移","children":[]},{"level":3,"title":"更多迁移参数","slug":"更多迁移参数","link":"#更多迁移参数","children":[]},{"level":3,"title":"特殊情况","slug":"特殊情况","link":"#特殊情况","children":[{"level":4,"title":"列名重命名","slug":"列名重命名","link":"#列名重命名","children":[]}]},{"level":3,"title":"删除迁移","slug":"删除迁移","link":"#删除迁移","children":[]},{"level":3,"title":"列出迁移","slug":"列出迁移","link":"#列出迁移","children":[]},{"level":3,"title":"生成SQL脚本","slug":"生成sql脚本","link":"#生成sql脚本","children":[{"level":4,"title":"生成从0到最新迁移的SQL脚本","slug":"生成从0到最新迁移的sql脚本","link":"#生成从0到最新迁移的sql脚本","children":[]},{"level":4,"title":"From","slug":"from","link":"#from","children":[]},{"level":4,"title":"From和To","slug":"from和to","link":"#from和to","children":[]}]}]},{"level":2,"title":"创建数据库和表","slug":"创建数据库和表","link":"#创建数据库和表","children":[{"level":3,"title":"手动执行","slug":"手动执行","link":"#手动执行","children":[]},{"level":3,"title":"更多参数","slug":"更多参数","link":"#更多参数","children":[]},{"level":3,"title":"运行时候执行","slug":"运行时候执行","link":"#运行时候执行","children":[]}]},{"level":2,"title":"创建和删除API","slug":"创建和删除api","link":"#创建和删除api","children":[{"level":3,"title":"EnsureDeleted","slug":"ensuredeleted","link":"#ensuredeleted","children":[]},{"level":3,"title":"EnsureCreated","slug":"ensurecreated","link":"#ensurecreated","children":[]},{"level":3,"title":"SQL 脚本","slug":"sql-脚本","link":"#sql-脚本","children":[]},{"level":3,"title":"多个 DbContext 类","slug":"多个-dbcontext-类","link":"#多个-dbcontext-类","children":[]}]},{"level":2,"title":"反向工程数据库优先","slug":"反向工程数据库优先","link":"#反向工程数据库优先","children":[]},{"level":2,"title":"参考文档","slug":"参考文档","link":"#参考文档","children":[]}],"git":{"createdTime":1690042937000,"updatedTime":1690097812000,"contributors":[{"name":"azrng","email":"itzhangyunpeng@163.com","commits":2}]},"readingTime":{"minutes":7.26,"words":2179},"filePathRelative":"orm/efcore/qianyishuju/efcorezhiminglinghanggongju.md","localizedDate":"2023年7月3日","excerpt":"<h2>介绍</h2>\\n<p>EFCore工具可帮助完成设计数据库时候的开发任务，主要用于通过对数据库架构进行反向工程来管理迁移和搭建DbContext和实体类型。EFCore .NET命令行工具是对跨平台.NET Core CLI工具的扩展，该工具执行需要具有.NET Core SDK(具有&nbsp;Sdk=\\"Microsoft.NET.Sdk\\"&nbsp;的项目或项目文件中的相似项目)的项目，优点是适用于所有平台。</p>\\n<h2>安装工具</h2>\\n<p>使用终端工具执行在任意目录执行下面命令，可以尝试下<a href=\\"https://docs.microsoft.com/zh-cn/windows/terminal/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Terminal</a>终端工具。</p>","autoDesc":true}');export{U as comp,V as data};
