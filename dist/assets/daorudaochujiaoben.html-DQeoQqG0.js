import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as n,e}from"./app-vSdX8vi3.js";const t={},p=e(`<h2 id="导出脚本" tabindex="-1"><a class="header-anchor" href="#导出脚本"><span>导出脚本</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>


<span class="token comment">## 获取到 &quot;image:tag&quot; 格式的镜像名</span>
<span class="token assign-left variable">IMG_NAME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span><span class="token function">docker</span> images <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> TAG <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $1&quot;:&quot;$2}&#39;</span><span class="token variable">\`</span></span>
<span class="token comment">## echo $IMG_NAME | awk &#39;{gsub(/ /,&quot;\\n&quot;,$0)} {print $0}&#39;</span>

<span class="token comment">## 如果原本镜像名中存在 &quot;/&quot; 是需要去掉的</span>

<span class="token comment">## 定义镜像存放目录</span>
<span class="token assign-left variable">DIR</span><span class="token operator">=</span><span class="token string">&quot;/data/docker/image_tar&quot;</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-d</span> <span class="token string">&quot;<span class="token variable">$DIR</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\\033">\\033</span>[34m<span class="token variable">\${DIR}</span><span class="token entity" title="\\033">\\033</span>[0m 不存在&quot;</span>
  <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token string">&quot;<span class="token variable">$DIR</span>&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\\033">\\033</span>[34m<span class="token variable">\${DIR}</span><span class="token entity" title="\\033">\\033</span>[0m 已创建&quot;</span>
<span class="token keyword">else</span>
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\\033">\\033</span>[34m<span class="token variable">\${DIR}</span><span class="token entity" title="\\033">\\033</span>[0m 已存在&quot;</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">IMAGE</span> <span class="token keyword">in</span> <span class="token variable">$IMG_NAME</span>
<span class="token keyword">do</span>
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;正在保存 <span class="token entity" title="\\033">\\033</span>[33m<span class="token variable">\${IMAGE}</span><span class="token entity" title="\\033">\\033</span>[0m&quot;</span>
  <span class="token assign-left variable">SAVE_NAME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">echo</span> $IMAGE <span class="token operator">|</span> <span class="token function">awk</span> -F: <span class="token string">&#39;{print $1&quot;_&quot;$2}&#39;</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;s/\\//_/g&#39;</span><span class="token variable">\`</span></span>
  <span class="token function">docker</span> save <span class="token variable">$IMAGE</span> <span class="token parameter variable">-o</span> <span class="token variable">\${DIR}</span>/<span class="token variable">\${SAVE_NAME}</span>.tar
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;已保存到 <span class="token entity" title="\\033">\\033</span>[34m<span class="token variable">\${DIR}</span>/<span class="token entity" title="\\033">\\033</span>[31m<span class="token variable">\${SAVE_NAME}</span>.tar<span class="token entity" title="\\033">\\033</span>[0m&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="导入脚本" tabindex="-1"><a class="header-anchor" href="#导入脚本"><span>导入脚本</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token comment">## 在此处填写镜像文件的保存目录</span>
<span class="token assign-left variable">IMAGE_DIR</span><span class="token operator">=</span><span class="token string">&quot;/data/docker/image_tar&quot;</span>

<span class="token keyword">for</span> <span class="token for-or-select variable">IMAGE</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">\`</span><span class="token function">ls</span> $IMAGE_DIR<span class="token variable">\`</span></span>
<span class="token keyword">do</span>
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;正在导入镜像 <span class="token entity" title="\\033">\\033</span>[33m<span class="token variable">$IMAGE</span><span class="token entity" title="\\033">\\033</span>[0m&quot;</span>
  <span class="token function">docker</span> load <span class="token parameter variable">-i</span> <span class="token variable">\${IMAGE_DIR}</span>/<span class="token variable">\${IMAGE}</span>
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;已成功导入镜像 <span class="token entity" title="\\033">\\033</span>[33m<span class="token variable">$IMAGE</span><span class="token entity" title="\\033">\\033</span>[0m&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),l=[p];function o(i,c){return s(),n("div",null,l)}const d=a(t,[["render",o],["__file","daorudaochujiaoben.html.vue"]]),m=JSON.parse('{"path":"/cloud/container/docker/jiaoben/daorudaochujiaoben.html","title":"导入导出脚本","lang":"zh-CN","frontmatter":{"title":"导入导出脚本","lang":"zh-CN","date":"2023-06-05T00:00:00.000Z","publish":true,"author":"azrng","isOriginal":true,"category":["cloud"],"tag":["无"],"filename":"daorudaochujiaoben","slug":"vvhf7x2dc8r945vi","docsId":"115949509","description":"导出脚本 导入脚本","head":[["meta",{"property":"og:url","content":"https://azrng.gitee.io/kbms/kbms/cloud/container/docker/jiaoben/daorudaochujiaoben.html"}],["meta",{"property":"og:site_name","content":"知识库"}],["meta",{"property":"og:title","content":"导入导出脚本"}],["meta",{"property":"og:description","content":"导出脚本 导入脚本"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-08T14:03:23.000Z"}],["meta",{"property":"article:author","content":"azrng"}],["meta",{"property":"article:tag","content":"无"}],["meta",{"property":"article:published_time","content":"2023-06-05T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-08T14:03:23.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"导入导出脚本\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-06-05T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-08T14:03:23.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"azrng\\"}]}"]]},"headers":[{"level":2,"title":"导出脚本","slug":"导出脚本","link":"#导出脚本","children":[]},{"level":2,"title":"导入脚本","slug":"导入脚本","link":"#导入脚本","children":[]}],"git":{"createdTime":1695541854000,"updatedTime":1712585003000,"contributors":[{"name":"azrng","email":"itzhangyunpeng@163.com","commits":2}]},"readingTime":{"minutes":0.84,"words":251},"filePathRelative":"cloud/container/docker/jiaoben/daorudaochujiaoben.md","localizedDate":"2023年6月5日","excerpt":"<h2>导出脚本</h2>\\n<div class=\\"language-bash\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code><span class=\\"token shebang important\\">#!/bin/bash</span>\\n\\n\\n<span class=\\"token comment\\">## 获取到 \\"image:tag\\" 格式的镜像名</span>\\n<span class=\\"token assign-left variable\\">IMG_NAME</span><span class=\\"token operator\\">=</span><span class=\\"token variable\\"><span class=\\"token variable\\">`</span><span class=\\"token function\\">docker</span> images <span class=\\"token operator\\">|</span> <span class=\\"token function\\">grep</span> <span class=\\"token parameter variable\\">-v</span> TAG <span class=\\"token operator\\">|</span> <span class=\\"token function\\">awk</span> <span class=\\"token string\\">\'{print $1\\":\\"$2}\'</span><span class=\\"token variable\\">`</span></span>\\n<span class=\\"token comment\\">## echo $IMG_NAME | awk \'{gsub(/ /,\\"\\\\n\\",$0)} {print $0}\'</span>\\n\\n<span class=\\"token comment\\">## 如果原本镜像名中存在 \\"/\\" 是需要去掉的</span>\\n\\n<span class=\\"token comment\\">## 定义镜像存放目录</span>\\n<span class=\\"token assign-left variable\\">DIR</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">\\"/data/docker/image_tar\\"</span>\\n<span class=\\"token keyword\\">if</span> <span class=\\"token punctuation\\">[</span> <span class=\\"token operator\\">!</span> <span class=\\"token parameter variable\\">-d</span> <span class=\\"token string\\">\\"<span class=\\"token variable\\">$DIR</span>\\"</span> <span class=\\"token punctuation\\">]</span><span class=\\"token punctuation\\">;</span> <span class=\\"token keyword\\">then</span>\\n  <span class=\\"token builtin class-name\\">echo</span> <span class=\\"token parameter variable\\">-e</span> <span class=\\"token string\\">\\"<span class=\\"token entity\\" title=\\"\\\\033\\">\\\\033</span>[34m<span class=\\"token variable\\">${DIR}</span><span class=\\"token entity\\" title=\\"\\\\033\\">\\\\033</span>[0m 不存在\\"</span>\\n  <span class=\\"token function\\">mkdir</span> <span class=\\"token parameter variable\\">-p</span> <span class=\\"token string\\">\\"<span class=\\"token variable\\">$DIR</span>\\"</span>\\n  <span class=\\"token builtin class-name\\">echo</span> <span class=\\"token parameter variable\\">-e</span> <span class=\\"token string\\">\\"<span class=\\"token entity\\" title=\\"\\\\033\\">\\\\033</span>[34m<span class=\\"token variable\\">${DIR}</span><span class=\\"token entity\\" title=\\"\\\\033\\">\\\\033</span>[0m 已创建\\"</span>\\n<span class=\\"token keyword\\">else</span>\\n  <span class=\\"token builtin class-name\\">echo</span> <span class=\\"token parameter variable\\">-e</span> <span class=\\"token string\\">\\"<span class=\\"token entity\\" title=\\"\\\\033\\">\\\\033</span>[34m<span class=\\"token variable\\">${DIR}</span><span class=\\"token entity\\" title=\\"\\\\033\\">\\\\033</span>[0m 已存在\\"</span>\\n<span class=\\"token keyword\\">fi</span>\\n<span class=\\"token builtin class-name\\">echo</span> <span class=\\"token string\\">\\"\\"</span>\\n<span class=\\"token keyword\\">for</span> <span class=\\"token for-or-select variable\\">IMAGE</span> <span class=\\"token keyword\\">in</span> <span class=\\"token variable\\">$IMG_NAME</span>\\n<span class=\\"token keyword\\">do</span>\\n  <span class=\\"token builtin class-name\\">echo</span> <span class=\\"token parameter variable\\">-e</span> <span class=\\"token string\\">\\"正在保存 <span class=\\"token entity\\" title=\\"\\\\033\\">\\\\033</span>[33m<span class=\\"token variable\\">${IMAGE}</span><span class=\\"token entity\\" title=\\"\\\\033\\">\\\\033</span>[0m\\"</span>\\n  <span class=\\"token assign-left variable\\">SAVE_NAME</span><span class=\\"token operator\\">=</span><span class=\\"token variable\\"><span class=\\"token variable\\">`</span><span class=\\"token builtin class-name\\">echo</span> $IMAGE <span class=\\"token operator\\">|</span> <span class=\\"token function\\">awk</span> -F: <span class=\\"token string\\">\'{print $1\\"_\\"$2}\'</span> <span class=\\"token operator\\">|</span> <span class=\\"token function\\">sed</span> <span class=\\"token string\\">\'s/\\\\//_/g\'</span><span class=\\"token variable\\">`</span></span>\\n  <span class=\\"token function\\">docker</span> save <span class=\\"token variable\\">$IMAGE</span> <span class=\\"token parameter variable\\">-o</span> <span class=\\"token variable\\">${DIR}</span>/<span class=\\"token variable\\">${SAVE_NAME}</span>.tar\\n  <span class=\\"token builtin class-name\\">echo</span> <span class=\\"token parameter variable\\">-e</span> <span class=\\"token string\\">\\"已保存到 <span class=\\"token entity\\" title=\\"\\\\033\\">\\\\033</span>[34m<span class=\\"token variable\\">${DIR}</span>/<span class=\\"token entity\\" title=\\"\\\\033\\">\\\\033</span>[31m<span class=\\"token variable\\">${SAVE_NAME}</span>.tar<span class=\\"token entity\\" title=\\"\\\\033\\">\\\\033</span>[0m\\"</span>\\n  <span class=\\"token builtin class-name\\">echo</span> <span class=\\"token string\\">\\"\\"</span>\\n<span class=\\"token keyword\\">done</span>\\n</code></pre></div>","autoDesc":true}');export{d as comp,m as data};
