import{_ as o}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as p,o as i,c as l,a as n,d as s,e as t,b as e}from"./app-DMmdIwn0.js";const c={},r=n("h2",{id:"miniprofiler",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#miniprofiler"},[n("span",null,"MiniProfiler")])],-1),u=n("h3",{id:"概述",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#概述"},[n("span",null,"概述")])],-1),d={href:"https://miniprofiler.com/",target:"_blank",rel:"noopener noreferrer"},k=e(`<h3 id="安装组件" tabindex="-1"><a class="header-anchor" href="#安装组件"><span>安装组件</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>Install-Package MiniProfiler.AspNetCore.Mvc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="添加服务并启用服务" tabindex="-1"><a class="header-anchor" href="#添加服务并启用服务"><span>添加服务并启用服务</span></a></h3><p>注册服务</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token comment">//配置路由基础路径，默认地址是/mini-profiler-resources</span>
services<span class="token punctuation">.</span><span class="token function">AddMiniProfiler</span><span class="token punctuation">(</span>options <span class="token operator">=&gt;</span> options<span class="token punctuation">.</span>RouteBasePath <span class="token operator">=</span> <span class="token string">&quot;/profiler&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>启用服务</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>app<span class="token punctuation">.</span><span class="token function">UseMiniProfiler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,7),m={href:"http://localhost:8001/profiler/results",target:"_blank",rel:"noopener noreferrer"},g=n("h3",{id:"查阅效果",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#查阅效果"},[n("span",null,"查阅效果")])],-1),h={href:"http://localhost:8001/profiler/results",target:"_blank",rel:"noopener noreferrer"},v={href:"http://localhost:5969/profiler/results-index",target:"_blank",rel:"noopener noreferrer"},b=e(`<h3 id="单独监控分析的代码" tabindex="-1"><a class="header-anchor" href="#单独监控分析的代码"><span>单独监控分析的代码</span></a></h3><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token class-name"><span class="token keyword">string</span></span> url1 <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>
	<span class="token class-name"><span class="token keyword">string</span></span> url2 <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>
	<span class="token keyword">using</span> <span class="token punctuation">(</span>MiniProfiler<span class="token punctuation">.</span>Current<span class="token punctuation">.</span><span class="token function">Step</span><span class="token punctuation">(</span><span class="token string">&quot;Get方法&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">using</span> <span class="token punctuation">(</span>MiniProfiler<span class="token punctuation">.</span>Current<span class="token punctuation">.</span><span class="token function">Step</span><span class="token punctuation">(</span><span class="token string">&quot;准备数据&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">using</span> <span class="token punctuation">(</span>MiniProfiler<span class="token punctuation">.</span>Current<span class="token punctuation">.</span><span class="token function">CustomTiming</span><span class="token punctuation">(</span><span class="token string">&quot;SQL&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;SELECT * FROM Config&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token comment">// 模拟一个SQL查询</span>
				Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

				url1 <span class="token operator">=</span> <span class="token string">&quot;https://www.baidu.com&quot;</span><span class="token punctuation">;</span>
				url2 <span class="token operator">=</span> <span class="token string">&quot;https://www.sina.com.cn/&quot;</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">using</span> <span class="token punctuation">(</span>MiniProfiler<span class="token punctuation">.</span>Current<span class="token punctuation">.</span><span class="token function">Step</span><span class="token punctuation">(</span><span class="token string">&quot;使用从数据库中查询的数据，进行Http请求&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">using</span> <span class="token punctuation">(</span>MiniProfiler<span class="token punctuation">.</span>Current<span class="token punctuation">.</span><span class="token function">CustomTiming</span><span class="token punctuation">(</span><span class="token string">&quot;HTTP&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET &quot;</span> <span class="token operator">+</span> url1<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token class-name"><span class="token keyword">var</span></span> reply <span class="token operator">=</span> _httpClient<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>url1<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">using</span> <span class="token punctuation">(</span>MiniProfiler<span class="token punctuation">.</span>Current<span class="token punctuation">.</span><span class="token function">CustomTiming</span><span class="token punctuation">(</span><span class="token string">&quot;HTTP&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET &quot;</span> <span class="token operator">+</span> url2<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token class-name"><span class="token keyword">var</span></span> reply <span class="token operator">=</span> _httpClient<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>url2<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> <span class="token string">&quot;value1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;value2&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>代码解释：</p><ul><li><code>MiniProfiler.Current.Step</code>方法定义了分析的步骤，这个方法可以接受一个<code>String</code>类型的参数，它会显示在最终的报告中</li><li><code>MiniProfiler.Current.CustomTiming</code>方法是更细粒度的对报告内容进行分类，以上代码中定义了2种分类，一种是SQL, 一种是Http</li><li>上述程序的功能： 模拟从数据库拉取2个网站的Url, 并使用<code>WebClient</code>来分别请求网站的Url</li></ul></blockquote><p>让某些代码不要显示在 mini-profile 中，需要做的是调用 Ignore() 即可，如下代码所示：</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token punctuation">(</span>MiniProfiler<span class="token punctuation">.</span>Current<span class="token punctuation">.</span><span class="token function">Ignore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">// Write code here that you don&#39;t</span>
  <span class="token comment">// want MiniProfiler to profile</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="swagger集成" tabindex="-1"><a class="header-anchor" href="#swagger集成"><span>Swagger集成</span></a></h3><p>下载index页面放到根目录，下载地址</p>`,7),f={href:"https://github.com/domaindrivendev/Swashbuckle.AspNetCore/blob/master/src/Swashbuckle.AspNetCore.SwaggerUI/index.html",target:"_blank",rel:"noopener noreferrer"},q=e(`<p>在该文件的头部加入下面脚本</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token operator">&lt;</span><span class="token class-name">script</span> <span class="token keyword">async</span><span class="token operator">=</span><span class="token string">&quot;async&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;mini-profiler&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;/profiler/includes.min.js?v=4.0.138+gcc91adf599&quot;</span> 
        data<span class="token operator">-</span>version<span class="token operator">=</span><span class="token string">&quot;4.0.138+gcc91adf599&quot;</span> data<span class="token operator">-</span>path<span class="token operator">=</span><span class="token string">&quot;/profiler/&quot;</span> 
        data<span class="token operator">-</span>current<span class="token operator">-</span>id<span class="token operator">=</span><span class="token string">&quot;4ec7c742-49d4-4eaf-8281-3c1e0efa748a&quot;</span> data<span class="token operator">-</span>ids<span class="token operator">=</span><span class="token string">&quot;&quot;</span> data<span class="token operator">-</span>position<span class="token operator">=</span><span class="token string">&quot;Left&quot;</span> 
        data<span class="token operator">-</span>authorized<span class="token operator">=</span><span class="token string">&quot;true&quot;</span> data<span class="token operator">-</span>max<span class="token operator">-</span>traces<span class="token operator">=</span><span class="token string">&quot;15&quot;</span> data<span class="token operator">-</span>toggle<span class="token operator">-</span>shortcut<span class="token operator">=</span><span class="token string">&quot;Alt+P&quot;</span> 
        data<span class="token operator">-</span>trivial<span class="token operator">-</span>milliseconds<span class="token operator">=</span><span class="token string">&quot;2.0&quot;</span> data<span class="token operator">-</span>ignored<span class="token operator">-</span>duplicate<span class="token operator">-</span>execute<span class="token operator">-</span>types<span class="token operator">=</span><span class="token string">&quot;Open,OpenAsync,Close,CloseAsync&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将该文件设置为嵌入资源始终复制 安装自定义页面，需要在启用swagger配置地方增加</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>c<span class="token punctuation">.</span>IndexStream <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetTypeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span><span class="token function">GetManifestResourceStream</span><span class="token punctuation">(</span><span class="token string">&quot;APIStudy.index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>注意：APIStudy是你项目的命名空间</p></blockquote><h2 id="资料" tabindex="-1"><a class="header-anchor" href="#资料"><span>资料</span></a></h2>`,6),y={href:"https://www.cnblogs.com/sylone/p/11024386.html",target:"_blank",rel:"noopener noreferrer"};function _(w,x){const a=p("ExternalLinkIcon");return i(),l("div",null,[r,u,n("p",null,[s("一个简单但有效的mini分析器。 官网："),n("a",d,[s("https://miniprofiler.com/"),t(a)])]),k,n("blockquote",null,[n("p",null,[s("查看请求时间地址："),n("a",m,[s("http://localhost:8001/profiler/results"),t(a)]),s(" 当前页面只会显示最近一次的请求")])]),g,n("p",null,[s("如果想看最后一次请求的效果："),n("a",h,[s("http://localhost:8001/profiler/results"),t(a)]),s(" 如果想看列表："),n("a",v,[s("http://localhost:8001/profiler/results-index"),t(a)])]),b,n("blockquote",null,[n("p",null,[n("a",f,[s("https://github.com/domaindrivendev/Swashbuckle.AspNetCore/blob/master/src/Swashbuckle.AspNetCore.SwaggerUI/index.html"),t(a)])])]),q,n("blockquote",null,[n("p",null,[s("参考教程："),n("a",y,[s("https://www.cnblogs.com/sylone/p/11024386.html"),t(a)])])])])}const T=o(c,[["render",_],["__file","fenxigongju.html.vue"]]),M=JSON.parse('{"path":"/dotnet/daimafenxi/fenxigongju.html","title":"分析工具","lang":"zh-CN","frontmatter":{"title":"分析工具","lang":"zh-CN","date":"2023-10-05T00:00:00.000Z","publish":true,"author":"azrng","isOriginal":true,"category":["dotNET"],"tag":["无"],"filename":"fenxigongju","slug":"tedi5k","docsId":"32029315","description":"MiniProfiler 概述 一个简单但有效的mini分析器。 官网：https://miniprofiler.com/ 安装组件 添加服务并启用服务 注册服务 启用服务 查看请求时间地址：http://localhost:8001/profiler/results 当前页面只会显示最近一次的请求 查阅效果 如果想看最后一次请求的效果：http://...","head":[["meta",{"property":"og:url","content":"https://azrng.gitee.io/kbms/kbms/dotnet/daimafenxi/fenxigongju.html"}],["meta",{"property":"og:site_name","content":"知识库"}],["meta",{"property":"og:title","content":"分析工具"}],["meta",{"property":"og:description","content":"MiniProfiler 概述 一个简单但有效的mini分析器。 官网：https://miniprofiler.com/ 安装组件 添加服务并启用服务 注册服务 启用服务 查看请求时间地址：http://localhost:8001/profiler/results 当前页面只会显示最近一次的请求 查阅效果 如果想看最后一次请求的效果：http://..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-10-22T08:11:43.000Z"}],["meta",{"property":"article:author","content":"azrng"}],["meta",{"property":"article:tag","content":"无"}],["meta",{"property":"article:published_time","content":"2023-10-05T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-10-22T08:11:43.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"分析工具\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-10-05T00:00:00.000Z\\",\\"dateModified\\":\\"2023-10-22T08:11:43.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"azrng\\"}]}"]]},"headers":[{"level":2,"title":"MiniProfiler","slug":"miniprofiler","link":"#miniprofiler","children":[{"level":3,"title":"概述","slug":"概述","link":"#概述","children":[]},{"level":3,"title":"安装组件","slug":"安装组件","link":"#安装组件","children":[]},{"level":3,"title":"添加服务并启用服务","slug":"添加服务并启用服务","link":"#添加服务并启用服务","children":[]},{"level":3,"title":"查阅效果","slug":"查阅效果","link":"#查阅效果","children":[]},{"level":3,"title":"单独监控分析的代码","slug":"单独监控分析的代码","link":"#单独监控分析的代码","children":[]},{"level":3,"title":"Swagger集成","slug":"swagger集成","link":"#swagger集成","children":[]}]},{"level":2,"title":"资料","slug":"资料","link":"#资料","children":[]}],"git":{"createdTime":1697962303000,"updatedTime":1697962303000,"contributors":[{"name":"azrng","email":"itzhangyunpeng@163.com","commits":1}]},"readingTime":{"minutes":1.92,"words":575},"filePathRelative":"dotnet/daimafenxi/fenxigongju.md","localizedDate":"2023年10月5日","excerpt":"<h2>MiniProfiler</h2>\\n<h3>概述</h3>\\n<p>一个简单但有效的mini分析器。\\n官网：<a href=\\"https://miniprofiler.com/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://miniprofiler.com/</a></p>\\n<h3>安装组件</h3>\\n<div class=\\"language-bash\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code>Install-Package MiniProfiler.AspNetCore.Mvc\\n</code></pre></div>","autoDesc":true}');export{T as comp,M as data};
