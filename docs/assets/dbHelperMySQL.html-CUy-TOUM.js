import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,o as a,d as l}from"./app-BguyEeV-.js";const i={},p=l(`<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>public class DbHelperMySQL</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    //数据库连接字符串(web.config来配置)，可以动态更改connectionString支持多数据库.</span></span>
<span class="line"><span>    public static string connectionString = &quot;server=localhost;database=table1;uid=root;pwd=123456&quot;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #region 最大值</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 得到最大值</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;FieldName&quot;&gt;字段名&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;TableName&quot;&gt;表名字&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>
<span class="line"><span>    public static int GetMaxID(string FieldName, string TableName)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        string strsql = &quot;select max(&quot; + FieldName + &quot;)+1 from &quot; + TableName;</span></span>
<span class="line"><span>        object obj = GetSingle(strsql);</span></span>
<span class="line"><span>        if (obj == null)</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            return 1;</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>        else</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            return int.Parse(obj.ToString());</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #endregion</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #region 是否存在</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 是否存在</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;strSql&quot;&gt;&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>
<span class="line"><span>    public static bool Exists(string strSql)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        object obj = GetSingle(strSql);</span></span>
<span class="line"><span>        int cmdresult;</span></span>
<span class="line"><span>        if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            cmdresult = 0;</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>        else</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            cmdresult = int.Parse(obj.ToString());</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        return cmdresult != 0;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 是否存在（基于MySqlParameter）</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;strSql&quot;&gt;&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;cmdParms&quot;&gt;&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>
<span class="line"><span>    public static bool Exists(string strSql, params MySqlParameter[] cmdParms)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        object obj = GetSingle(strSql, cmdParms);</span></span>
<span class="line"><span>        int cmdresult;</span></span>
<span class="line"><span>        if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            cmdresult = 0;</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>        else</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            cmdresult = int.Parse(obj.ToString());</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        return cmdresult != 0;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #endregion</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #region 增删改</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 返回影响的记录数</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;SQLString&quot;&gt;SQL语句&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;影响的记录数&lt;/returns&gt;</span></span>
<span class="line"><span>    public static int ExecuteSql(string SQLString)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            using (MySqlCommand cmd = new MySqlCommand(SQLString, connection))</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                try</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    connection.Open();</span></span>
<span class="line"><span>                    return cmd.ExecuteNonQuery();</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>                catch (MySqlException e)</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    connection.Close();</span></span>
<span class="line"><span>                    throw e;</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 返回受影响行数</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;sql&quot;&gt;sql&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;times&quot;&gt;超时时间&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>
<span class="line"><span>    public static int ExecuteSqlByTime(string sql, int times)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            using (MySqlCommand cmd = new MySqlCommand(sql, connection))</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                try</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    connection.Open();</span></span>
<span class="line"><span>                    cmd.CommandTimeout = times;</span></span>
<span class="line"><span>                    int rows = cmd.ExecuteNonQuery();</span></span>
<span class="line"><span>                    return rows;</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>                catch (MySql.Data.MySqlClient.MySqlException e)</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    connection.Close();</span></span>
<span class="line"><span>                    throw e;</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 返回受影响行数</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;SQLString&quot;&gt;strsql&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;cmdParms&quot;&gt;参数&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>
<span class="line"><span>    public static int ExecuteSql(string SQLString, params MySqlParameter[] cmdParms)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            if (connection.State == ConnectionState.Closed)</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                connection.Open();</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>            using (MySqlCommand cmd = new MySqlCommand(SQLString, connection))</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                if (cmdParms != null)</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    cmd.Parameters.AddRange(cmdParms);</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                try</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    return Convert.ToInt32(cmd.ExecuteNonQuery());</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>                catch (Exception)</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    return 0;</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #endregion</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #region 执行多条SQL语句</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 执行多条SQL语句，实现数据库事务。</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;SQLStringList&quot;&gt;多条SQL语句&lt;/param&gt;</span></span>
<span class="line"><span>    public static int ExecuteSqlTran(List&lt;String&gt; SQLStringList)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (MySqlConnection conn = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            conn.Open();</span></span>
<span class="line"><span>            MySqlCommand cmd = new MySqlCommand();</span></span>
<span class="line"><span>            cmd.Connection = conn;</span></span>
<span class="line"><span>            MySqlTransaction tx = conn.BeginTransaction();</span></span>
<span class="line"><span>            cmd.Transaction = tx;</span></span>
<span class="line"><span>            try</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                int count = 0;</span></span>
<span class="line"><span>                for (int n = 0; n &lt; SQLStringList.Count; n++)</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    string strsql = SQLStringList[n];</span></span>
<span class="line"><span>                    if (strsql.Trim().Length &gt; 1)</span></span>
<span class="line"><span>                    {</span></span>
<span class="line"><span>                        cmd.CommandText = strsql;</span></span>
<span class="line"><span>                        count += cmd.ExecuteNonQuery();</span></span>
<span class="line"><span>                    }</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                tx.Commit();</span></span>
<span class="line"><span>                return count;</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>            catch</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                tx.Rollback();</span></span>
<span class="line"><span>                return 0;</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #endregion</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #region 首行首列</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 首行首列</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;SQLString&quot;&gt;计算查询结果语句&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;查询结果（object）&lt;/returns&gt;</span></span>
<span class="line"><span>    public static object GetSingle(string SQLString)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            using (MySqlCommand cmd = new MySqlCommand(SQLString, connection))</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                try</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    connection.Open();</span></span>
<span class="line"><span>                    object obj = cmd.ExecuteScalar();</span></span>
<span class="line"><span>                    if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))</span></span>
<span class="line"><span>                    {</span></span>
<span class="line"><span>                        return null;</span></span>
<span class="line"><span>                    }</span></span>
<span class="line"><span>                    else</span></span>
<span class="line"><span>                    {</span></span>
<span class="line"><span>                        return obj;</span></span>
<span class="line"><span>                    }</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>                catch (MySql.Data.MySqlClient.MySqlException e)</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    connection.Close();</span></span>
<span class="line"><span>                    throw e;</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 首行首列</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;SQLString&quot;&gt;sql语句&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;Times&quot;&gt;过期时间&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>
<span class="line"><span>    public static object GetSingle(string SQLString, int Times)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            using (MySqlCommand cmd = new MySqlCommand(SQLString, connection))</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                try</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    connection.Open();</span></span>
<span class="line"><span>                    cmd.CommandTimeout = Times;</span></span>
<span class="line"><span>                    object obj = cmd.ExecuteScalar();</span></span>
<span class="line"><span>                    if (Equals(obj, null) || (Equals(obj, DBNull.Value)))</span></span>
<span class="line"><span>                    {</span></span>
<span class="line"><span>                        return null;</span></span>
<span class="line"><span>                    }</span></span>
<span class="line"><span>                    else</span></span>
<span class="line"><span>                    {</span></span>
<span class="line"><span>                        return obj;</span></span>
<span class="line"><span>                    }</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>                catch (MySqlException e)</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    connection.Close();</span></span>
<span class="line"><span>                    throw e;</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 首行首列</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;SQLString&quot;&gt;strsql&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;cmdParms&quot;&gt;参数&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;首行首列&lt;/returns&gt;</span></span>
<span class="line"><span>    public static object GetSingle(string SQLString, params MySqlParameter[] cmdParms)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            using (MySqlCommand cmd = new MySqlCommand())</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                try</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    PrepareCommand(cmd, connection, null, SQLString, cmdParms);</span></span>
<span class="line"><span>                    object obj = cmd.ExecuteScalar();</span></span>
<span class="line"><span>                    cmd.Parameters.Clear();</span></span>
<span class="line"><span>                    if ((Equals(obj, null)) || (Equals(obj, DBNull.Value)))</span></span>
<span class="line"><span>                    {</span></span>
<span class="line"><span>                        return null;</span></span>
<span class="line"><span>                    }</span></span>
<span class="line"><span>                    else</span></span>
<span class="line"><span>                    {</span></span>
<span class="line"><span>                        return obj;</span></span>
<span class="line"><span>                    }</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>                catch (MySqlException e)</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    throw e;</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #endregion</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #region 查询</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 执行查询语句，返回DataSet</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;SQLString&quot;&gt;查询语句&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;DataSet&lt;/returns&gt;</span></span>
<span class="line"><span>    public static DataSet Query(string SQLString)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            DataSet ds = new DataSet();</span></span>
<span class="line"><span>            try</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                connection.Open();</span></span>
<span class="line"><span>                MySqlDataAdapter command = new MySqlDataAdapter(SQLString, connection);</span></span>
<span class="line"><span>                command.Fill(ds, &quot;ds&quot;);</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>            catch (MySqlException ex)</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                throw new Exception(ex.Message);</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>            return ds;</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 执行查询语句，返回DataSet</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;SQLString&quot;&gt;sql语句&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;Times&quot;&gt;过期时间&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>
<span class="line"><span>    public static DataSet Query(string SQLString, int Times)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            DataSet ds = new DataSet();</span></span>
<span class="line"><span>            try</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                connection.Open();</span></span>
<span class="line"><span>                MySqlDataAdapter command = new MySqlDataAdapter(SQLString, connection);</span></span>
<span class="line"><span>                command.SelectCommand.CommandTimeout = Times;</span></span>
<span class="line"><span>                command.Fill(ds, &quot;ds&quot;);</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>            catch (MySqlException ex)</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                throw new Exception(ex.Message);</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>            return ds;</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 执行查询语句，返回DataSet</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;SQLString&quot;&gt;strsql&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;cmdParms&quot;&gt;参数&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;返回DataSet&lt;/returns&gt;</span></span>
<span class="line"><span>    public static DataSet GetData(string SQLString, params MySqlParameter[] cmdParms)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            MySqlCommand cmd = new MySqlCommand();</span></span>
<span class="line"><span>            PrepareCommand(cmd, connection, null, SQLString, cmdParms);</span></span>
<span class="line"><span>            using (MySqlDataAdapter da = new MySqlDataAdapter(cmd))</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                DataSet ds = new DataSet();</span></span>
<span class="line"><span>                try</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    da.Fill(ds);</span></span>
<span class="line"><span>                    cmd.Parameters.Clear();</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>                catch (MySqlException ex)</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    throw new Exception(ex.Message);</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                return ds;</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #endregion</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #region 执行存储过程</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 执行存储过程</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;ProcName&quot;&gt;存储过程名称&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;parm&quot;&gt;参数&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>
<span class="line"><span>    public static MySqlDataReader GetDataTableByProc(string ProcName, params MySqlParameter[] parm)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        MySqlConnection conn = new MySqlConnection(connectionString);</span></span>
<span class="line"><span>        using (MySqlCommand cmd = new MySqlCommand(ProcName, conn))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            if (conn.State == ConnectionState.Closed)</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                conn.Open();</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>            if (parm != null)</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                cmd.Parameters.AddRange(parm);</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>            cmd.CommandType = CommandType.StoredProcedure;</span></span>
<span class="line"><span>            return cmd.ExecuteReader(CommandBehavior.CloseConnection);</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #endregion</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #region 扩展</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 执行sql语句</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    private static void PrepareCommand(MySqlCommand cmd, MySqlConnection conn, MySqlTransaction trans,</span></span>
<span class="line"><span>        string cmdText, MySqlParameter[] cmdParms)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        if (conn.State != ConnectionState.Open)</span></span>
<span class="line"><span>            conn.Open();</span></span>
<span class="line"><span>        cmd.Connection = conn;</span></span>
<span class="line"><span>        cmd.CommandText = cmdText;</span></span>
<span class="line"><span>        if (trans != null)</span></span>
<span class="line"><span>            cmd.Transaction = trans;</span></span>
<span class="line"><span>        cmd.CommandType = CommandType.Text; //cmdType;</span></span>
<span class="line"><span>        if (cmdParms != null)</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            foreach (MySqlParameter parameter in cmdParms)</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                if ((parameter.Direction == ParameterDirection.InputOutput ||</span></span>
<span class="line"><span>                        parameter.Direction == ParameterDirection.Input) &amp;&amp;</span></span>
<span class="line"><span>                    (parameter.Value == null))</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    parameter.Value = DBNull.Value;</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                cmd.Parameters.Add(parameter);</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 执行多条SQL语句，实现数据库事务。</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;SQLStringList&quot;&gt;SQL语句的哈希表（key为sql语句，value是该语句的MySqlParameter[]）&lt;/param&gt;</span></span>
<span class="line"><span>    public static void ExecuteSqlTran(Hashtable SQLStringList)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (MySqlConnection conn = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            conn.Open();</span></span>
<span class="line"><span>            using (MySqlTransaction trans = conn.BeginTransaction())</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                MySqlCommand cmd = new MySqlCommand();</span></span>
<span class="line"><span>                try</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    //循环</span></span>
<span class="line"><span>                    foreach (DictionaryEntry myDE in SQLStringList)</span></span>
<span class="line"><span>                    {</span></span>
<span class="line"><span>                        string cmdText = myDE.Key.ToString();</span></span>
<span class="line"><span>                        MySqlParameter[] cmdParms = (MySqlParameter[])myDE.Value;</span></span>
<span class="line"><span>                        PrepareCommand(cmd, conn, trans, cmdText, cmdParms);</span></span>
<span class="line"><span>                        int val = cmd.ExecuteNonQuery();</span></span>
<span class="line"><span>                        cmd.Parameters.Clear();</span></span>
<span class="line"><span>                    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                    trans.Commit();</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>                catch</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    trans.Rollback();</span></span>
<span class="line"><span>                    throw;</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 执行多条SQL语句，实现数据库事务。</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;SQLStringList&quot;&gt;SQL语句的哈希表（key为sql语句，value是该语句的MySqlParameter[]）&lt;/param&gt;</span></span>
<span class="line"><span>    public static void ExecuteSqlTranWithIndentity(Hashtable SQLStringList)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (MySqlConnection conn = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            conn.Open();</span></span>
<span class="line"><span>            using (MySqlTransaction trans = conn.BeginTransaction())</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                MySqlCommand cmd = new MySqlCommand();</span></span>
<span class="line"><span>                try</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    int indentity = 0;</span></span>
<span class="line"><span>                    //循环</span></span>
<span class="line"><span>                    foreach (DictionaryEntry myDE in SQLStringList)</span></span>
<span class="line"><span>                    {</span></span>
<span class="line"><span>                        string cmdText = myDE.Key.ToString();</span></span>
<span class="line"><span>                        MySqlParameter[] cmdParms = (MySqlParameter[])myDE.Value;</span></span>
<span class="line"><span>                        foreach (MySqlParameter q in cmdParms)</span></span>
<span class="line"><span>                        {</span></span>
<span class="line"><span>                            if (q.Direction == ParameterDirection.InputOutput)</span></span>
<span class="line"><span>                            {</span></span>
<span class="line"><span>                                q.Value = indentity;</span></span>
<span class="line"><span>                            }</span></span>
<span class="line"><span>                        }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                        PrepareCommand(cmd, conn, trans, cmdText, cmdParms);</span></span>
<span class="line"><span>                        int val = cmd.ExecuteNonQuery();</span></span>
<span class="line"><span>                        foreach (MySqlParameter q in cmdParms)</span></span>
<span class="line"><span>                        {</span></span>
<span class="line"><span>                            if (q.Direction == ParameterDirection.Output)</span></span>
<span class="line"><span>                            {</span></span>
<span class="line"><span>                                indentity = Convert.ToInt32(q.Value);</span></span>
<span class="line"><span>                            }</span></span>
<span class="line"><span>                        }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                        cmd.Parameters.Clear();</span></span>
<span class="line"><span>                    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                    trans.Commit();</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>                catch</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    trans.Rollback();</span></span>
<span class="line"><span>                    throw;</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #region 查询 * ( 注意：调用该方法后，一定要对MySqlDataReader进行Close )</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// MySqlDataReader查询 * ( 注意：调用该方法后，一定要对MySqlDataReader进行Close )</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;strSQL&quot;&gt;查询语句&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;MySqlDataReader&lt;/returns&gt;</span></span>
<span class="line"><span>    public static MySqlDataReader ExecuteReader(string SQLString, params MySqlParameter[] cmdParms)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        MySqlDataReader sqldata = null;</span></span>
<span class="line"><span>        MySqlConnection connection = new MySqlConnection(connectionString);</span></span>
<span class="line"><span>        MySqlCommand cmd = new MySqlCommand();</span></span>
<span class="line"><span>        try</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            PrepareCommand(cmd, connection, null, SQLString, cmdParms);</span></span>
<span class="line"><span>            MySqlDataReader myReader = cmd.ExecuteReader(CommandBehavior.CloseConnection);</span></span>
<span class="line"><span>            cmd.Parameters.Clear();</span></span>
<span class="line"><span>            sqldata = myReader;</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>        catch (MySqlException)</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            sqldata = null;</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        return sqldata;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 执行查询语句，返回MySqlDataReader ( 注意：调用该方法后，一定要对MySqlDataReader进行Close )</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;strSql&quot;&gt;查询语句&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;MySqlDataReader&lt;/returns&gt;</span></span>
<span class="line"><span>    public static MySqlDataReader ExecuteReader(string strSql)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        var connection = new MySqlConnection(connectionString);</span></span>
<span class="line"><span>        var cmd = new MySqlCommand(strSql, connection);</span></span>
<span class="line"><span>        try</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            connection.Open();</span></span>
<span class="line"><span>            var myReader = cmd.ExecuteReader(CommandBehavior.CloseConnection);</span></span>
<span class="line"><span>            return myReader;</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>        catch (MySql.Data.MySqlClient.MySqlException e)</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            throw e;</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #endregion</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 执行带一个存储过程参数的的SQL语句。</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;sqlString&quot;&gt;SQL语句&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;content&quot;&gt;参数内容,比如一个字段是格式复杂的文章，有特殊符号，可以通过这个方式添加&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;影响的记录数&lt;/returns&gt;</span></span>
<span class="line"><span>    public static int ExecuteSql(string sqlString, string content)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (var connection = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            var cmd = new MySqlCommand(sqlString, connection);</span></span>
<span class="line"><span>            var myParameter = new MySqlParameter(&quot;@content&quot;, SqlDbType.NText) { Value = content };</span></span>
<span class="line"><span>            cmd.Parameters.Add(myParameter);</span></span>
<span class="line"><span>            try</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                connection.Open();</span></span>
<span class="line"><span>                var rows = cmd.ExecuteNonQuery();</span></span>
<span class="line"><span>                return rows;</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>            catch (MySqlException e)</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                throw e;</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>            finally</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                cmd.Dispose();</span></span>
<span class="line"><span>                connection.Close();</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 执行带一个存储过程参数的的SQL语句。</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;sqlString&quot;&gt;SQL语句&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;content&quot;&gt;参数内容,比如一个字段是格式复杂的文章，有特殊符号，可以通过这个方式添加&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;影响的记录数&lt;/returns&gt;</span></span>
<span class="line"><span>    public static object ExecuteSqlGet(string sqlString, string content)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (var connection = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            var cmd = new MySqlCommand(sqlString, connection);</span></span>
<span class="line"><span>            var myParameter = new MySqlParameter(&quot;@content&quot;, SqlDbType.NText) { Value = content };</span></span>
<span class="line"><span>            cmd.Parameters.Add(myParameter);</span></span>
<span class="line"><span>            try</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                connection.Open();</span></span>
<span class="line"><span>                var obj = cmd.ExecuteScalar();</span></span>
<span class="line"><span>                if ((object.Equals(obj, null)) || (object.Equals(obj, DBNull.Value)))</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    return null;</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>                else</span></span>
<span class="line"><span>                {</span></span>
<span class="line"><span>                    return obj;</span></span>
<span class="line"><span>                }</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>            catch (MySqlException e)</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                throw e;</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>            finally</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                cmd.Dispose();</span></span>
<span class="line"><span>                connection.Close();</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /// &lt;summary&gt;</span></span>
<span class="line"><span>    /// 向数据库里插入图像格式的字段(和上面情况类似的另一种实例)</span></span>
<span class="line"><span>    /// &lt;/summary&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;strSql&quot;&gt;SQL语句&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;param name=&quot;fs&quot;&gt;图像字节,数据库的字段类型为image的情况&lt;/param&gt;</span></span>
<span class="line"><span>    /// &lt;returns&gt;影响的记录数&lt;/returns&gt;</span></span>
<span class="line"><span>    public static int ExecuteSqlInsertImg(string strSql, byte[] fs)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        using (var connection = new MySqlConnection(connectionString))</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            var cmd = new MySqlCommand(strSql, connection);</span></span>
<span class="line"><span>            var myParameter =</span></span>
<span class="line"><span>                new MySqlParameter(&quot;@fs&quot;, SqlDbType.Image) { Value = fs };</span></span>
<span class="line"><span>            cmd.Parameters.Add(myParameter);</span></span>
<span class="line"><span>            try</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                connection.Open();</span></span>
<span class="line"><span>                return cmd.ExecuteNonQuery();</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>            catch (MySqlException e)</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                throw e;</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>            finally</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                cmd.Dispose();</span></span>
<span class="line"><span>                connection.Close();</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #endregion</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),e=[p];function c(d,v){return a(),s("div",null,e)}const t=n(i,[["render",c],["__file","dbHelperMySQL.html.vue"]]),u=JSON.parse('{"path":"/dataBase/mysql/dbHelperMySQL.html","title":"DbHelperMySQL","lang":"zh-CN","frontmatter":{"title":"DbHelperMySQL","lang":"zh-CN","date":"2021-05-14T00:00:00.000Z","publish":true,"author":"azrng","isOriginal":true,"category":["dataBase"],"tag":["helper"],"head":[["meta",{"property":"og:url","content":"https://azrng.gitee.io/kbms/kbms/dataBase/mysql/dbHelperMySQL.html"}],["meta",{"property":"og:site_name","content":"知识库"}],["meta",{"property":"og:title","content":"DbHelperMySQL"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-12-18T14:41:28.000Z"}],["meta",{"property":"article:author","content":"azrng"}],["meta",{"property":"article:tag","content":"helper"}],["meta",{"property":"article:published_time","content":"2021-05-14T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-12-18T14:41:28.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"DbHelperMySQL\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2021-05-14T00:00:00.000Z\\",\\"dateModified\\":\\"2023-12-18T14:41:28.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"azrng\\"}]}"]]},"headers":[],"git":{"createdTime":1695484404000,"updatedTime":1702910488000,"contributors":[{"name":"azrng","email":"itzhangyunpeng@163.com","commits":1}]},"readingTime":{"minutes":6.2,"words":1860},"filePathRelative":"dataBase/mysql/dbHelperMySQL.md","localizedDate":"2021年5月14日","excerpt":"<div class=\\"language- line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"\\" data-title=\\"\\" style=\\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes github-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span>public class DbHelperMySQL</span></span>\\n<span class=\\"line\\"><span>{</span></span>\\n<span class=\\"line\\"><span>    //数据库连接字符串(web.config来配置)，可以动态更改connectionString支持多数据库.</span></span>\\n<span class=\\"line\\"><span>    public static string connectionString = \\"server=localhost;database=table1;uid=root;pwd=123456\\";</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #region 最大值</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 得到最大值</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"FieldName\\"&gt;字段名&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"TableName\\"&gt;表名字&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static int GetMaxID(string FieldName, string TableName)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        string strsql = \\"select max(\\" + FieldName + \\")+1 from \\" + TableName;</span></span>\\n<span class=\\"line\\"><span>        object obj = GetSingle(strsql);</span></span>\\n<span class=\\"line\\"><span>        if (obj == null)</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            return 1;</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>        else</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            return int.Parse(obj.ToString());</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #endregion</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #region 是否存在</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 是否存在</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"strSql\\"&gt;&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static bool Exists(string strSql)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        object obj = GetSingle(strSql);</span></span>\\n<span class=\\"line\\"><span>        int cmdresult;</span></span>\\n<span class=\\"line\\"><span>        if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            cmdresult = 0;</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>        else</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            cmdresult = int.Parse(obj.ToString());</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>        return cmdresult != 0;</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 是否存在（基于MySqlParameter）</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"strSql\\"&gt;&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"cmdParms\\"&gt;&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static bool Exists(string strSql, params MySqlParameter[] cmdParms)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        object obj = GetSingle(strSql, cmdParms);</span></span>\\n<span class=\\"line\\"><span>        int cmdresult;</span></span>\\n<span class=\\"line\\"><span>        if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            cmdresult = 0;</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>        else</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            cmdresult = int.Parse(obj.ToString());</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>        return cmdresult != 0;</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #endregion</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #region 增删改</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 返回影响的记录数</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"SQLString\\"&gt;SQL语句&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;影响的记录数&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static int ExecuteSql(string SQLString)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            using (MySqlCommand cmd = new MySqlCommand(SQLString, connection))</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                try</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    connection.Open();</span></span>\\n<span class=\\"line\\"><span>                    return cmd.ExecuteNonQuery();</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>                catch (MySqlException e)</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    connection.Close();</span></span>\\n<span class=\\"line\\"><span>                    throw e;</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 返回受影响行数</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"sql\\"&gt;sql&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"times\\"&gt;超时时间&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static int ExecuteSqlByTime(string sql, int times)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            using (MySqlCommand cmd = new MySqlCommand(sql, connection))</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                try</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    connection.Open();</span></span>\\n<span class=\\"line\\"><span>                    cmd.CommandTimeout = times;</span></span>\\n<span class=\\"line\\"><span>                    int rows = cmd.ExecuteNonQuery();</span></span>\\n<span class=\\"line\\"><span>                    return rows;</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>                catch (MySql.Data.MySqlClient.MySqlException e)</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    connection.Close();</span></span>\\n<span class=\\"line\\"><span>                    throw e;</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 返回受影响行数</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"SQLString\\"&gt;strsql&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"cmdParms\\"&gt;参数&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static int ExecuteSql(string SQLString, params MySqlParameter[] cmdParms)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            if (connection.State == ConnectionState.Closed)</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                connection.Open();</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>            using (MySqlCommand cmd = new MySqlCommand(SQLString, connection))</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                if (cmdParms != null)</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    cmd.Parameters.AddRange(cmdParms);</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>                try</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    return Convert.ToInt32(cmd.ExecuteNonQuery());</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>                catch (Exception)</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    return 0;</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #endregion</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #region 执行多条SQL语句</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 执行多条SQL语句，实现数据库事务。</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"SQLStringList\\"&gt;多条SQL语句&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    public static int ExecuteSqlTran(List&lt;String&gt; SQLStringList)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (MySqlConnection conn = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            conn.Open();</span></span>\\n<span class=\\"line\\"><span>            MySqlCommand cmd = new MySqlCommand();</span></span>\\n<span class=\\"line\\"><span>            cmd.Connection = conn;</span></span>\\n<span class=\\"line\\"><span>            MySqlTransaction tx = conn.BeginTransaction();</span></span>\\n<span class=\\"line\\"><span>            cmd.Transaction = tx;</span></span>\\n<span class=\\"line\\"><span>            try</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                int count = 0;</span></span>\\n<span class=\\"line\\"><span>                for (int n = 0; n &lt; SQLStringList.Count; n++)</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    string strsql = SQLStringList[n];</span></span>\\n<span class=\\"line\\"><span>                    if (strsql.Trim().Length &gt; 1)</span></span>\\n<span class=\\"line\\"><span>                    {</span></span>\\n<span class=\\"line\\"><span>                        cmd.CommandText = strsql;</span></span>\\n<span class=\\"line\\"><span>                        count += cmd.ExecuteNonQuery();</span></span>\\n<span class=\\"line\\"><span>                    }</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>                tx.Commit();</span></span>\\n<span class=\\"line\\"><span>                return count;</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>            catch</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                tx.Rollback();</span></span>\\n<span class=\\"line\\"><span>                return 0;</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #endregion</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #region 首行首列</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 首行首列</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"SQLString\\"&gt;计算查询结果语句&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;查询结果（object）&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static object GetSingle(string SQLString)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            using (MySqlCommand cmd = new MySqlCommand(SQLString, connection))</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                try</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    connection.Open();</span></span>\\n<span class=\\"line\\"><span>                    object obj = cmd.ExecuteScalar();</span></span>\\n<span class=\\"line\\"><span>                    if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))</span></span>\\n<span class=\\"line\\"><span>                    {</span></span>\\n<span class=\\"line\\"><span>                        return null;</span></span>\\n<span class=\\"line\\"><span>                    }</span></span>\\n<span class=\\"line\\"><span>                    else</span></span>\\n<span class=\\"line\\"><span>                    {</span></span>\\n<span class=\\"line\\"><span>                        return obj;</span></span>\\n<span class=\\"line\\"><span>                    }</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>                catch (MySql.Data.MySqlClient.MySqlException e)</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    connection.Close();</span></span>\\n<span class=\\"line\\"><span>                    throw e;</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 首行首列</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"SQLString\\"&gt;sql语句&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"Times\\"&gt;过期时间&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static object GetSingle(string SQLString, int Times)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            using (MySqlCommand cmd = new MySqlCommand(SQLString, connection))</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                try</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    connection.Open();</span></span>\\n<span class=\\"line\\"><span>                    cmd.CommandTimeout = Times;</span></span>\\n<span class=\\"line\\"><span>                    object obj = cmd.ExecuteScalar();</span></span>\\n<span class=\\"line\\"><span>                    if (Equals(obj, null) || (Equals(obj, DBNull.Value)))</span></span>\\n<span class=\\"line\\"><span>                    {</span></span>\\n<span class=\\"line\\"><span>                        return null;</span></span>\\n<span class=\\"line\\"><span>                    }</span></span>\\n<span class=\\"line\\"><span>                    else</span></span>\\n<span class=\\"line\\"><span>                    {</span></span>\\n<span class=\\"line\\"><span>                        return obj;</span></span>\\n<span class=\\"line\\"><span>                    }</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>                catch (MySqlException e)</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    connection.Close();</span></span>\\n<span class=\\"line\\"><span>                    throw e;</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 首行首列</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"SQLString\\"&gt;strsql&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"cmdParms\\"&gt;参数&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;首行首列&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static object GetSingle(string SQLString, params MySqlParameter[] cmdParms)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            using (MySqlCommand cmd = new MySqlCommand())</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                try</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    PrepareCommand(cmd, connection, null, SQLString, cmdParms);</span></span>\\n<span class=\\"line\\"><span>                    object obj = cmd.ExecuteScalar();</span></span>\\n<span class=\\"line\\"><span>                    cmd.Parameters.Clear();</span></span>\\n<span class=\\"line\\"><span>                    if ((Equals(obj, null)) || (Equals(obj, DBNull.Value)))</span></span>\\n<span class=\\"line\\"><span>                    {</span></span>\\n<span class=\\"line\\"><span>                        return null;</span></span>\\n<span class=\\"line\\"><span>                    }</span></span>\\n<span class=\\"line\\"><span>                    else</span></span>\\n<span class=\\"line\\"><span>                    {</span></span>\\n<span class=\\"line\\"><span>                        return obj;</span></span>\\n<span class=\\"line\\"><span>                    }</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>                catch (MySqlException e)</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    throw e;</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #endregion</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #region 查询</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 执行查询语句，返回DataSet</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"SQLString\\"&gt;查询语句&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;DataSet&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static DataSet Query(string SQLString)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            DataSet ds = new DataSet();</span></span>\\n<span class=\\"line\\"><span>            try</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                connection.Open();</span></span>\\n<span class=\\"line\\"><span>                MySqlDataAdapter command = new MySqlDataAdapter(SQLString, connection);</span></span>\\n<span class=\\"line\\"><span>                command.Fill(ds, \\"ds\\");</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>            catch (MySqlException ex)</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                throw new Exception(ex.Message);</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>            return ds;</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 执行查询语句，返回DataSet</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"SQLString\\"&gt;sql语句&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"Times\\"&gt;过期时间&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static DataSet Query(string SQLString, int Times)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            DataSet ds = new DataSet();</span></span>\\n<span class=\\"line\\"><span>            try</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                connection.Open();</span></span>\\n<span class=\\"line\\"><span>                MySqlDataAdapter command = new MySqlDataAdapter(SQLString, connection);</span></span>\\n<span class=\\"line\\"><span>                command.SelectCommand.CommandTimeout = Times;</span></span>\\n<span class=\\"line\\"><span>                command.Fill(ds, \\"ds\\");</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>            catch (MySqlException ex)</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                throw new Exception(ex.Message);</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>            return ds;</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 执行查询语句，返回DataSet</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"SQLString\\"&gt;strsql&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"cmdParms\\"&gt;参数&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;返回DataSet&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static DataSet GetData(string SQLString, params MySqlParameter[] cmdParms)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (MySqlConnection connection = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            MySqlCommand cmd = new MySqlCommand();</span></span>\\n<span class=\\"line\\"><span>            PrepareCommand(cmd, connection, null, SQLString, cmdParms);</span></span>\\n<span class=\\"line\\"><span>            using (MySqlDataAdapter da = new MySqlDataAdapter(cmd))</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                DataSet ds = new DataSet();</span></span>\\n<span class=\\"line\\"><span>                try</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    da.Fill(ds);</span></span>\\n<span class=\\"line\\"><span>                    cmd.Parameters.Clear();</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>                catch (MySqlException ex)</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    throw new Exception(ex.Message);</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>                return ds;</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #endregion</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #region 执行存储过程</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 执行存储过程</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"ProcName\\"&gt;存储过程名称&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"parm\\"&gt;参数&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static MySqlDataReader GetDataTableByProc(string ProcName, params MySqlParameter[] parm)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        MySqlConnection conn = new MySqlConnection(connectionString);</span></span>\\n<span class=\\"line\\"><span>        using (MySqlCommand cmd = new MySqlCommand(ProcName, conn))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            if (conn.State == ConnectionState.Closed)</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                conn.Open();</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>            if (parm != null)</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                cmd.Parameters.AddRange(parm);</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>            cmd.CommandType = CommandType.StoredProcedure;</span></span>\\n<span class=\\"line\\"><span>            return cmd.ExecuteReader(CommandBehavior.CloseConnection);</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #endregion</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #region 扩展</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 执行sql语句</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    private static void PrepareCommand(MySqlCommand cmd, MySqlConnection conn, MySqlTransaction trans,</span></span>\\n<span class=\\"line\\"><span>        string cmdText, MySqlParameter[] cmdParms)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        if (conn.State != ConnectionState.Open)</span></span>\\n<span class=\\"line\\"><span>            conn.Open();</span></span>\\n<span class=\\"line\\"><span>        cmd.Connection = conn;</span></span>\\n<span class=\\"line\\"><span>        cmd.CommandText = cmdText;</span></span>\\n<span class=\\"line\\"><span>        if (trans != null)</span></span>\\n<span class=\\"line\\"><span>            cmd.Transaction = trans;</span></span>\\n<span class=\\"line\\"><span>        cmd.CommandType = CommandType.Text; //cmdType;</span></span>\\n<span class=\\"line\\"><span>        if (cmdParms != null)</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            foreach (MySqlParameter parameter in cmdParms)</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                if ((parameter.Direction == ParameterDirection.InputOutput ||</span></span>\\n<span class=\\"line\\"><span>                        parameter.Direction == ParameterDirection.Input) &amp;&amp;</span></span>\\n<span class=\\"line\\"><span>                    (parameter.Value == null))</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    parameter.Value = DBNull.Value;</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>                cmd.Parameters.Add(parameter);</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 执行多条SQL语句，实现数据库事务。</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"SQLStringList\\"&gt;SQL语句的哈希表（key为sql语句，value是该语句的MySqlParameter[]）&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    public static void ExecuteSqlTran(Hashtable SQLStringList)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (MySqlConnection conn = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            conn.Open();</span></span>\\n<span class=\\"line\\"><span>            using (MySqlTransaction trans = conn.BeginTransaction())</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                MySqlCommand cmd = new MySqlCommand();</span></span>\\n<span class=\\"line\\"><span>                try</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    //循环</span></span>\\n<span class=\\"line\\"><span>                    foreach (DictionaryEntry myDE in SQLStringList)</span></span>\\n<span class=\\"line\\"><span>                    {</span></span>\\n<span class=\\"line\\"><span>                        string cmdText = myDE.Key.ToString();</span></span>\\n<span class=\\"line\\"><span>                        MySqlParameter[] cmdParms = (MySqlParameter[])myDE.Value;</span></span>\\n<span class=\\"line\\"><span>                        PrepareCommand(cmd, conn, trans, cmdText, cmdParms);</span></span>\\n<span class=\\"line\\"><span>                        int val = cmd.ExecuteNonQuery();</span></span>\\n<span class=\\"line\\"><span>                        cmd.Parameters.Clear();</span></span>\\n<span class=\\"line\\"><span>                    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>                    trans.Commit();</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>                catch</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    trans.Rollback();</span></span>\\n<span class=\\"line\\"><span>                    throw;</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 执行多条SQL语句，实现数据库事务。</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"SQLStringList\\"&gt;SQL语句的哈希表（key为sql语句，value是该语句的MySqlParameter[]）&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    public static void ExecuteSqlTranWithIndentity(Hashtable SQLStringList)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (MySqlConnection conn = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            conn.Open();</span></span>\\n<span class=\\"line\\"><span>            using (MySqlTransaction trans = conn.BeginTransaction())</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                MySqlCommand cmd = new MySqlCommand();</span></span>\\n<span class=\\"line\\"><span>                try</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    int indentity = 0;</span></span>\\n<span class=\\"line\\"><span>                    //循环</span></span>\\n<span class=\\"line\\"><span>                    foreach (DictionaryEntry myDE in SQLStringList)</span></span>\\n<span class=\\"line\\"><span>                    {</span></span>\\n<span class=\\"line\\"><span>                        string cmdText = myDE.Key.ToString();</span></span>\\n<span class=\\"line\\"><span>                        MySqlParameter[] cmdParms = (MySqlParameter[])myDE.Value;</span></span>\\n<span class=\\"line\\"><span>                        foreach (MySqlParameter q in cmdParms)</span></span>\\n<span class=\\"line\\"><span>                        {</span></span>\\n<span class=\\"line\\"><span>                            if (q.Direction == ParameterDirection.InputOutput)</span></span>\\n<span class=\\"line\\"><span>                            {</span></span>\\n<span class=\\"line\\"><span>                                q.Value = indentity;</span></span>\\n<span class=\\"line\\"><span>                            }</span></span>\\n<span class=\\"line\\"><span>                        }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>                        PrepareCommand(cmd, conn, trans, cmdText, cmdParms);</span></span>\\n<span class=\\"line\\"><span>                        int val = cmd.ExecuteNonQuery();</span></span>\\n<span class=\\"line\\"><span>                        foreach (MySqlParameter q in cmdParms)</span></span>\\n<span class=\\"line\\"><span>                        {</span></span>\\n<span class=\\"line\\"><span>                            if (q.Direction == ParameterDirection.Output)</span></span>\\n<span class=\\"line\\"><span>                            {</span></span>\\n<span class=\\"line\\"><span>                                indentity = Convert.ToInt32(q.Value);</span></span>\\n<span class=\\"line\\"><span>                            }</span></span>\\n<span class=\\"line\\"><span>                        }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>                        cmd.Parameters.Clear();</span></span>\\n<span class=\\"line\\"><span>                    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>                    trans.Commit();</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>                catch</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    trans.Rollback();</span></span>\\n<span class=\\"line\\"><span>                    throw;</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #region 查询 * ( 注意：调用该方法后，一定要对MySqlDataReader进行Close )</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// MySqlDataReader查询 * ( 注意：调用该方法后，一定要对MySqlDataReader进行Close )</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"strSQL\\"&gt;查询语句&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;MySqlDataReader&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static MySqlDataReader ExecuteReader(string SQLString, params MySqlParameter[] cmdParms)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        MySqlDataReader sqldata = null;</span></span>\\n<span class=\\"line\\"><span>        MySqlConnection connection = new MySqlConnection(connectionString);</span></span>\\n<span class=\\"line\\"><span>        MySqlCommand cmd = new MySqlCommand();</span></span>\\n<span class=\\"line\\"><span>        try</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            PrepareCommand(cmd, connection, null, SQLString, cmdParms);</span></span>\\n<span class=\\"line\\"><span>            MySqlDataReader myReader = cmd.ExecuteReader(CommandBehavior.CloseConnection);</span></span>\\n<span class=\\"line\\"><span>            cmd.Parameters.Clear();</span></span>\\n<span class=\\"line\\"><span>            sqldata = myReader;</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>        catch (MySqlException)</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            sqldata = null;</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>        return sqldata;</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 执行查询语句，返回MySqlDataReader ( 注意：调用该方法后，一定要对MySqlDataReader进行Close )</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"strSql\\"&gt;查询语句&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;MySqlDataReader&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static MySqlDataReader ExecuteReader(string strSql)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        var connection = new MySqlConnection(connectionString);</span></span>\\n<span class=\\"line\\"><span>        var cmd = new MySqlCommand(strSql, connection);</span></span>\\n<span class=\\"line\\"><span>        try</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            connection.Open();</span></span>\\n<span class=\\"line\\"><span>            var myReader = cmd.ExecuteReader(CommandBehavior.CloseConnection);</span></span>\\n<span class=\\"line\\"><span>            return myReader;</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>        catch (MySql.Data.MySqlClient.MySqlException e)</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            throw e;</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #endregion</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 执行带一个存储过程参数的的SQL语句。</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"sqlString\\"&gt;SQL语句&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"content\\"&gt;参数内容,比如一个字段是格式复杂的文章，有特殊符号，可以通过这个方式添加&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;影响的记录数&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static int ExecuteSql(string sqlString, string content)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (var connection = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            var cmd = new MySqlCommand(sqlString, connection);</span></span>\\n<span class=\\"line\\"><span>            var myParameter = new MySqlParameter(\\"@content\\", SqlDbType.NText) { Value = content };</span></span>\\n<span class=\\"line\\"><span>            cmd.Parameters.Add(myParameter);</span></span>\\n<span class=\\"line\\"><span>            try</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                connection.Open();</span></span>\\n<span class=\\"line\\"><span>                var rows = cmd.ExecuteNonQuery();</span></span>\\n<span class=\\"line\\"><span>                return rows;</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>            catch (MySqlException e)</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                throw e;</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>            finally</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                cmd.Dispose();</span></span>\\n<span class=\\"line\\"><span>                connection.Close();</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 执行带一个存储过程参数的的SQL语句。</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"sqlString\\"&gt;SQL语句&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"content\\"&gt;参数内容,比如一个字段是格式复杂的文章，有特殊符号，可以通过这个方式添加&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;影响的记录数&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static object ExecuteSqlGet(string sqlString, string content)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (var connection = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            var cmd = new MySqlCommand(sqlString, connection);</span></span>\\n<span class=\\"line\\"><span>            var myParameter = new MySqlParameter(\\"@content\\", SqlDbType.NText) { Value = content };</span></span>\\n<span class=\\"line\\"><span>            cmd.Parameters.Add(myParameter);</span></span>\\n<span class=\\"line\\"><span>            try</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                connection.Open();</span></span>\\n<span class=\\"line\\"><span>                var obj = cmd.ExecuteScalar();</span></span>\\n<span class=\\"line\\"><span>                if ((object.Equals(obj, null)) || (object.Equals(obj, DBNull.Value)))</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    return null;</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>                else</span></span>\\n<span class=\\"line\\"><span>                {</span></span>\\n<span class=\\"line\\"><span>                    return obj;</span></span>\\n<span class=\\"line\\"><span>                }</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>            catch (MySqlException e)</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                throw e;</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>            finally</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                cmd.Dispose();</span></span>\\n<span class=\\"line\\"><span>                connection.Close();</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    /// &lt;summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// 向数据库里插入图像格式的字段(和上面情况类似的另一种实例)</span></span>\\n<span class=\\"line\\"><span>    /// &lt;/summary&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"strSql\\"&gt;SQL语句&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;param name=\\"fs\\"&gt;图像字节,数据库的字段类型为image的情况&lt;/param&gt;</span></span>\\n<span class=\\"line\\"><span>    /// &lt;returns&gt;影响的记录数&lt;/returns&gt;</span></span>\\n<span class=\\"line\\"><span>    public static int ExecuteSqlInsertImg(string strSql, byte[] fs)</span></span>\\n<span class=\\"line\\"><span>    {</span></span>\\n<span class=\\"line\\"><span>        using (var connection = new MySqlConnection(connectionString))</span></span>\\n<span class=\\"line\\"><span>        {</span></span>\\n<span class=\\"line\\"><span>            var cmd = new MySqlCommand(strSql, connection);</span></span>\\n<span class=\\"line\\"><span>            var myParameter =</span></span>\\n<span class=\\"line\\"><span>                new MySqlParameter(\\"@fs\\", SqlDbType.Image) { Value = fs };</span></span>\\n<span class=\\"line\\"><span>            cmd.Parameters.Add(myParameter);</span></span>\\n<span class=\\"line\\"><span>            try</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                connection.Open();</span></span>\\n<span class=\\"line\\"><span>                return cmd.ExecuteNonQuery();</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>            catch (MySqlException e)</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                throw e;</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>            finally</span></span>\\n<span class=\\"line\\"><span>            {</span></span>\\n<span class=\\"line\\"><span>                cmd.Dispose();</span></span>\\n<span class=\\"line\\"><span>                connection.Close();</span></span>\\n<span class=\\"line\\"><span>            }</span></span>\\n<span class=\\"line\\"><span>        }</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    #endregion</span></span>\\n<span class=\\"line\\"><span>}</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>"}');export{t as comp,u as data};
