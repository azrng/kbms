import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,o as a,e as n}from"./app-BY9DQv5u.js";const e={},l=n(`<h2 id="镜像搜索" tabindex="-1"><a class="header-anchor" href="#镜像搜索"><span>镜像搜索</span></a></h2><p>微软发布的镜像列表：<a href="https://mcr.microsoft.com/" target="_blank" rel="noopener noreferrer">https://mcr.microsoft.com/</a></p><h2 id="netcore镜像" tabindex="-1"><a class="header-anchor" href="#netcore镜像"><span>NetCore镜像</span></a></h2><h3 id="官方镜像" tabindex="-1"><a class="header-anchor" href="#官方镜像"><span>官方镜像</span></a></h3><p>官网镜像地址：<a href="https://mcr.microsoft.com/product/dotnet/sdk/about" target="_blank" rel="noopener noreferrer">https://mcr.microsoft.com/product/dotnet/sdk/about</a><br> dockerHub镜像地址：<a href="https://hub.docker.com/_/microsoft-dotnet" target="_blank" rel="noopener noreferrer">https://hub.docker.com/_/microsoft-dotnet</a></p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">aspnet镜像</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">包含.NET Core Runtime、ASP.NET Core框架组件、依赖项，该镜像为生产部署做了一些优化。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">runtime镜像</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.NetCore 运行时镜像，但不包含ASP.NET Core框架。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">net5默认的</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">FROM mcr.microsoft.com/dotnet/aspnet:5.0 AS base</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">FROM mcr.microsoft.com/dotnet/sdk:5.0 AS build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">net5 console dockerfile</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">FROM mcr.microsoft.com/dotnet/runtime:5.0 AS base</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">FROM mcr.microsoft.com/dotnet/sdk:5.0 AS build</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Alpine Linux是体积最小的Linux发行版</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">mcr.microsoft.com/dotnet/aspnet:5.0-alpine</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">mcr.microsoft.com/dotnet/sdk:5.0-alpine</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="修改镜像源" tabindex="-1"><a class="header-anchor" href="#修改镜像源"><span>修改镜像源</span></a></h4><p>aspnet:8.0镜像基于 debian:12-slim 构建</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>自 Debian 12 (bookworm) 开始，Debian 的容器镜像开始使用 DEB822 格式，而非之前的单行格式。 原先应该修改的 /etc/apt/sources.list 文件现在已被移除。现在，默认源的相关配置已被移至 /etc/apt/sources.list.d/debian.sources 文件。</p></div><p>该文件默认内容为</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">root@12eea2be0dc9:/etc/apt/sources.list.d#</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> debian.sources</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Types:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> deb</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># http://snapshot.debian.org/archive/debian/20240423T150000Z</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">URIs:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> http://deb.debian.org/debian</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Suites:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bookworm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bookworm-updates</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Components:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> main</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Signed-By:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /usr/share/keyrings/debian-archive-keyring.gpg</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Types:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> deb</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># http://snapshot.debian.org/archive/debian-security/20240423T150000Z</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">URIs:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> http://deb.debian.org/debian-security</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Suites:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bookworm-security</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Components:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> main</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Signed-By:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /usr/share/keyrings/debian-archive-keyring.gpg</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>dockerfile中使用root用户这么操作</p><div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" data-title="dockerfile" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> mcr.microsoft.com/dotnet/aspnet:8.0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> base</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 不使用root运行提示  couldn&#39;t open temporary file /etc/apt/sources.list.d/sedxOZ83A: Permission denied</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#USER $APP_UID</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">WORKDIR</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> /app</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">EXPOSE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> 8080</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">EXPOSE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> 8081</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 更新debian:12-slim源为 http://mirrors.aliyun.com/ 限速，这里使用中科大源： https://mirrors.ustc.edu.cn/debian/</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 设置支持导出excel</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> sed -i </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;s@deb.debian.org@mirrors.ustc.edu.cn@g&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> /etc/apt/sources.list.d/debian.sources &amp;&amp; \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    apt update &amp;&amp; apt install -y libgdiplus &amp;&amp; \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    ln -s /usr/lib/libgdiplus.so /usr/lib/gdiplus.dll</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="alpine镜像" tabindex="-1"><a class="header-anchor" href="#alpine镜像"><span>alpine镜像</span></a></h3><p>使用alpine构建更小的镜像(在镜像后面加 -alpine 就行了)</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>aspnet:6.0-alpine3.18和aspnet:6.0-alpine的区别是前者属于Alpine Linux操作系统的特定版本号，后者指的是alpine该标签的最新版本Alpine Linux镜像。如果你的应用程序已经针对alpine3.18进行了测试和优化，那么你应该使用该特定版本以保持一致性。</p></div><p>操作示例</p><div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" data-title="dockerfile" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> mcr.microsoft.com/dotnet/aspnet:6.0-alpine3.18 </span><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> base</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">WORKDIR</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> /app</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">EXPOSE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> 80</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 设置地区</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">ENV</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> TZ Asia/Shanghai</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">ENV</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> DOTNET_SYSTEM_GLOBALIZATION_INVARIANT=false</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 支持excel导出以及时间</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> apk add --no-cache tzdata libstdc++ libintl icu &amp;&amp; ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; echo $TZ &gt; /etc/timezone</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> mcr.microsoft.com/dotnet/sdk:6.0-alpine3.18 </span><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> build</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">ARG</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> BUILD_CONFIGURATION=Release</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">WORKDIR</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> /src</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;WebApplication8/WebApplication8.csproj&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;WebApplication8/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> dotnet restore </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./WebApplication8/./WebApplication8.csproj&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> . .</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">WORKDIR</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/src/WebApplication8&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> dotnet build </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./WebApplication8.csproj&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> -c $BUILD_CONFIGURATION -o /app/build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> build </span><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> publish</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">ARG</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> BUILD_CONFIGURATION=Release</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> dotnet publish </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./WebApplication8.csproj&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> -c $BUILD_CONFIGURATION -o /app/publish /p:UseAppHost=false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> base </span><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> final</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">WORKDIR</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> /app</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> --from=publish /app/publish .</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#61AFEF;">ENTRYPOINT</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dotnet&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;WebApplication8.dll&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="镜像加速器" tabindex="-1"><a class="header-anchor" href="#镜像加速器"><span>镜像加速器</span></a></h2><p>国内使用官方Docker Hub仓库实在是太慢了，很影响效率，如果在linux系统使用命令编辑文件：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/docker/daemon.json</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>加入下面的内容，docker-cn镜像：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>{</span></span>
<span class="line"><span>  &quot;registry-mirrors&quot;: [&quot;https://registry.docker-cn.com&quot;]</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>腾讯云的服务器那么请加入：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>{</span></span>
<span class="line"><span>  &quot;registry-mirrors&quot;: [&quot;https://mirror.ccs.tencentyun.com&quot;]</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>阿里云的服务器需要加入：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>{</span></span>
<span class="line"><span>  &quot;registry-mirrors&quot;: [&quot;https://dv91qnkv.mirror.aliyuncs.com&quot;]</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>自己的阿里云加速地址去这里看：<a href="https://cr.console.aliyun.com/cn-qingdao/instances/mirrors" target="_blank" rel="noopener noreferrer">https://cr.console.aliyun.com/cn-qingdao/instances/mirrors</a></p><p>还可以使用dockerproxy代理：<a href="https://dockerproxy.com/" target="_blank" rel="noopener noreferrer">https://dockerproxy.com/</a></p><p>wq保存退出：执行命令生效：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="镜像打包上传" tabindex="-1"><a class="header-anchor" href="#镜像打包上传"><span>镜像打包上传</span></a></h2><h3 id="查看服务器镜像" tabindex="-1"><a class="header-anchor" href="#查看服务器镜像"><span>查看服务器镜像</span></a></h3><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> images</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="镜像推送" tabindex="-1"><a class="header-anchor" href="#镜像推送"><span>镜像推送</span></a></h3><h4 id="docker-hub" tabindex="-1"><a class="header-anchor" href="#docker-hub"><span>Docker Hub</span></a></h4><p>上镜像上传docker hub是需要先登录docker hub，可以在命令行中输入下面的内容</p><div class="language-csharp line-numbers-mode" data-highlighter="shiki" data-ext="csharp" data-title="csharp" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">docker</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> login</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>如果需要，可以访问 <a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">Docker Hub 网站</a>来重置密码。</p></blockquote><p>输入下面的命令将重新标记或者重命名docker镜像</p><div class="language-csharp line-numbers-mode" data-highlighter="shiki" data-ext="csharp" data-title="csharp" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">docker</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> pizzafrontend</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">YOUR</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> DOCKER</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> USER</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pizzafrontend</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">docker</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> pizzabackend</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">YOUR</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> DOCKER</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> USER</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pizzabackend</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>最后将docker镜像上推送到docker hub</p><div class="language-csharp line-numbers-mode" data-highlighter="shiki" data-ext="csharp" data-title="csharp" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">docker</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> push</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">YOUR</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> DOCKER</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> USER</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pizzafrontend</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">docker</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> push</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">YOUR</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> DOCKER</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> USER</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pizzabackend</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="阿里云镜像源" tabindex="-1"><a class="header-anchor" href="#阿里云镜像源"><span>阿里云镜像源</span></a></h4><div class="language-csharp line-numbers-mode" data-highlighter="shiki" data-ext="csharp" data-title="csharp" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sudo</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> docker</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> login</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> --</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">username</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">itzhangyunpeng</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> registry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cn</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hangzhou</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliyuncs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">com</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> 然后将指定镜像打包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sudo</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> docker</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> tag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ImageId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">registry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cn</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hangzhou</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliyuncs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">com</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">zrng</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">dotnetruntime</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">镜像版本号</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>将镜像推送到仓库</p><div class="language-csharp line-numbers-mode" data-highlighter="shiki" data-ext="csharp" data-title="csharp" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sudo</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> docker</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> push</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> registry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cn</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hangzhou</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliyuncs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">com</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">zrng</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E06C75;">dotnetruntime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">镜像版本号</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>拉取镜像</p><div class="language-csharp line-numbers-mode" data-highlighter="shiki" data-ext="csharp" data-title="csharp" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sudo</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> docker</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> pull</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> registry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cn</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hangzhou</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliyuncs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">com</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">zrng</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E06C75;">dotnetruntime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">镜像版本号</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="镜像推送工具" tabindex="-1"><a class="header-anchor" href="#镜像推送工具"><span>镜像推送工具</span></a></h3><h4 id="jib" tabindex="-1"><a class="header-anchor" href="#jib"><span>jib</span></a></h4><p>不依赖docker环境就可以创建docker或者OCI类型的镜像。 功能包含：</p><ul><li>构建镜像推送到镜像仓库(dockerhub/aliyun/tencent共有仓库,harbor等私有仓库)</li><li>构建镜像推送到本地docker环境</li><li>构建镜像生成tar格式镜像文件到本地</li></ul><p>仓库地址：<a href="https://github.com/yuzd/jib" target="_blank" rel="noopener noreferrer">https://github.com/yuzd/jib</a><br> 参考地址：<a href="https://mp.weixin.qq.com/s/sIy0PbpPR92qTHcEOmuW6w" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/s/sIy0PbpPR92qTHcEOmuW6w</a></p>`,54),t=[l];function h(p,r){return a(),s("div",null,t)}const c=i(e,[["render",h],["__file","images.html.vue"]]),o=JSON.parse('{"path":"/cloud/container/docker/images.html","title":"镜像操作","lang":"zh-CN","frontmatter":{"title":"镜像操作","lang":"zh-CN","date":"2023-09-24T00:00:00.000Z","publish":true,"author":"azrng","isOriginal":true,"category":["cloud"],"tag":["images"],"description":"镜像搜索 微软发布的镜像列表：https://mcr.microsoft.com/ NetCore镜像 官方镜像 官网镜像地址：https://mcr.microsoft.com/product/dotnet/sdk/about dockerHub镜像地址：https://hub.docker.com/_/microsoft-dotnet 修改镜像源 ...","head":[["meta",{"property":"og:url","content":"https://azrng.gitee.io/kbms/kbms/cloud/container/docker/images.html"}],["meta",{"property":"og:site_name","content":"知识库"}],["meta",{"property":"og:title","content":"镜像操作"}],["meta",{"property":"og:description","content":"镜像搜索 微软发布的镜像列表：https://mcr.microsoft.com/ NetCore镜像 官方镜像 官网镜像地址：https://mcr.microsoft.com/product/dotnet/sdk/about dockerHub镜像地址：https://hub.docker.com/_/microsoft-dotnet 修改镜像源 ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-07T02:23:33.000Z"}],["meta",{"property":"article:author","content":"azrng"}],["meta",{"property":"article:tag","content":"images"}],["meta",{"property":"article:published_time","content":"2023-09-24T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-05-07T02:23:33.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"镜像操作\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-09-24T00:00:00.000Z\\",\\"dateModified\\":\\"2024-05-07T02:23:33.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"azrng\\"}]}"]]},"headers":[{"level":2,"title":"镜像搜索","slug":"镜像搜索","link":"#镜像搜索","children":[]},{"level":2,"title":"NetCore镜像","slug":"netcore镜像","link":"#netcore镜像","children":[{"level":3,"title":"官方镜像","slug":"官方镜像","link":"#官方镜像","children":[{"level":4,"title":"修改镜像源","slug":"修改镜像源","link":"#修改镜像源","children":[]}]},{"level":3,"title":"alpine镜像","slug":"alpine镜像","link":"#alpine镜像","children":[]}]},{"level":2,"title":"镜像加速器","slug":"镜像加速器","link":"#镜像加速器","children":[]},{"level":2,"title":"镜像打包上传","slug":"镜像打包上传","link":"#镜像打包上传","children":[{"level":3,"title":"查看服务器镜像","slug":"查看服务器镜像","link":"#查看服务器镜像","children":[]},{"level":3,"title":"镜像推送","slug":"镜像推送","link":"#镜像推送","children":[{"level":4,"title":"Docker Hub","slug":"docker-hub","link":"#docker-hub","children":[]},{"level":4,"title":"阿里云镜像源","slug":"阿里云镜像源","link":"#阿里云镜像源","children":[]}]},{"level":3,"title":"镜像推送工具","slug":"镜像推送工具","link":"#镜像推送工具","children":[{"level":4,"title":"jib","slug":"jib","link":"#jib","children":[]}]}]}],"git":{"createdTime":1695541854000,"updatedTime":1715048613000,"contributors":[{"name":"azrng","email":"itzhangyunpeng@163.com","commits":2},{"name":"zhangyunpeng","email":"zhang.yunpeng@synyi.com","commits":2}]},"readingTime":{"minutes":3.46,"words":1037},"filePathRelative":"cloud/container/docker/images.md","localizedDate":"2023年9月24日","excerpt":"<h2>镜像搜索</h2>\\n<p>微软发布的镜像列表：<a href=\\"https://mcr.microsoft.com/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://mcr.microsoft.com/</a></p>\\n<h2>NetCore镜像</h2>\\n<h3>官方镜像</h3>\\n<p>官网镜像地址：<a href=\\"https://mcr.microsoft.com/product/dotnet/sdk/about\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://mcr.microsoft.com/product/dotnet/sdk/about</a><br>\\ndockerHub镜像地址：<a href=\\"https://hub.docker.com/_/microsoft-dotnet\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://hub.docker.com/_/microsoft-dotnet</a></p>","autoDesc":true}');export{c as comp,o as data};
