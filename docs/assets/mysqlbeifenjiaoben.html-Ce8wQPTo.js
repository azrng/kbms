import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,o as a,d as n}from"./app-BuY9BHbl.js";const l={},h=n(`<h2 id="概述" tabindex="-1"><a class="header-anchor" href="#概述"><span>概述</span></a></h2><p>脚本默认备份全库，也可以备份某个表，可以设置保留周期，结果压缩，将备份结果发送邮件通知。</p><h2 id="内容" tabindex="-1"><a class="header-anchor" href="#内容"><span>内容</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 数据表名称，可以为空</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">table_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 数据库名称</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">database_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">test_data</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 备份周期，单位为天</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">backup_period</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">30</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 备份目录</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">backup_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">date</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">backup</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 邮箱地址</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">email_address</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">xxxxx</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">@</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">mail.qq</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## MySQL账号</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">mysql_user</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">root</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## MySQL密码</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">mysql_password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">root1234</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 获取当前日期</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">date_str</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">\`date </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">+%</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">Y</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">-%</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">m</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">-%</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">d\`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 备份文件名</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [[ </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">z </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$table_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ]]; then</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    backup_file_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{database_name}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">_$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{date_str}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.sql&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    backup_file_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{database_name}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">_$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{table_name}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">_$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{date_str}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.sql&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 压缩后备份文件名</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [[ </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">z </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$table_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ]]; then</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    compressed_backup_file_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{database_name}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">_$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{date_str}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.tar.gz&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    compressed_backup_file_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{database_name}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">_$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{table_name}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">_$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{date_str}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.tar.gz&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 备份文件路径</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">backup_file_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{backup_dir}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{backup_file_name}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 压缩后备份文件路径</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">compressed_backup_file_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{backup_dir}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/$</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{compressed_backup_file_name}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 检查备份目录是否存在，如果不存在则创建</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [[ ! </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">d </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$backup_dir&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ]]; then</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    mkdir </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">p </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$backup_dir&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 备份MySQL数据表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [[ </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">z </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$table_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ]]; then</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    mysqldump </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">u</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$mysql_user&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$mysql_password&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;$database_name&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;$backup_file_path&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    mysqldump </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">u</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$mysql_user&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$mysql_password&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;$database_name&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;$table_name&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;$backup_file_path&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 压缩备份文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">tar </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">czvf </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$compressed_backup_file_path&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;$backup_file_path&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 删除备份文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">rm </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">f </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$backup_file_path&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 检查备份结果</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [[ </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">f </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$compressed_backup_file_path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ]]; then</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    echo </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;备份成功！&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    echo </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;备份文件路径：$compressed_backup_file_path&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    subject</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;MySQL备份成功&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    body</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;MySQL备份成功，备份文件路径：$compressed_backup_file_path&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    echo </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;备份失败！&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    subject</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;MySQL备份失败&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    body</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;MySQL备份失败！&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 发送备份结果到指定邮箱</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">echo </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$body&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> mail </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">s </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$subject&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;$email_address&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## 删除过期备份文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">find </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$backup_dir&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">mtime </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;$backup_period&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">name </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;*.tar.gz&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">exec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> rm {} \\</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行示例</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#默认备份整库</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">mysql_back.sh</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#备份test_table_name表</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">mysql_back.sh test_table_name</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),t=[h];function k(e,p){return a(),i("div",null,t)}const y=s(l,[["render",k],["__file","mysqlbeifenjiaoben.html.vue"]]),g=JSON.parse('{"path":"/dataBase/mysql/jiaoben/mysqlbeifenjiaoben.html","title":"MySQL备份脚本","lang":"zh-CN","frontmatter":{"title":"MySQL备份脚本","lang":"zh-CN","date":"2023-02-27T00:00:00.000Z","publish":true,"author":"azrng","isOriginal":true,"category":["dataBase"],"tag":["无"],"filename":"mysqlbeifenjiaoben","slug":"qt6gbnn483gtqi6r","docsId":"115947937","description":"概述 脚本默认备份全库，也可以备份某个表，可以设置保留周期，结果压缩，将备份结果发送邮件通知。 内容 执行示例","head":[["meta",{"property":"og:url","content":"https://azrng.gitee.io/kbms/kbms/dataBase/mysql/jiaoben/mysqlbeifenjiaoben.html"}],["meta",{"property":"og:site_name","content":"知识库"}],["meta",{"property":"og:title","content":"MySQL备份脚本"}],["meta",{"property":"og:description","content":"概述 脚本默认备份全库，也可以备份某个表，可以设置保留周期，结果压缩，将备份结果发送邮件通知。 内容 执行示例"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-09-23T15:53:24.000Z"}],["meta",{"property":"article:author","content":"azrng"}],["meta",{"property":"article:tag","content":"无"}],["meta",{"property":"article:published_time","content":"2023-02-27T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-09-23T15:53:24.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"MySQL备份脚本\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-02-27T00:00:00.000Z\\",\\"dateModified\\":\\"2023-09-23T15:53:24.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"azrng\\"}]}"]]},"headers":[{"level":2,"title":"概述","slug":"概述","link":"#概述","children":[]},{"level":2,"title":"内容","slug":"内容","link":"#内容","children":[]}],"git":{"createdTime":1695484404000,"updatedTime":1695484404000,"contributors":[{"name":"azrng","email":"itzhangyunpeng@163.com","commits":1}]},"readingTime":{"minutes":1.3,"words":391},"filePathRelative":"dataBase/mysql/jiaoben/mysqlbeifenjiaoben.md","localizedDate":"2023年2月27日","excerpt":"<h2>概述</h2>\\n<p>脚本默认备份全库，也可以备份某个表，可以设置保留周期，结果压缩，将备份结果发送邮件通知。</p>\\n<h2>内容</h2>\\n<div class=\\"language-python line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"python\\" data-title=\\"python\\" style=\\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes github-light one-dark-pro vp-code\\"><code><span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">#!/bin/bash</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 数据表名称，可以为空</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">table_name</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit\\">$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">1</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 数据库名称</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">database_name</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">test_data</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 备份周期，单位为天</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">backup_period</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">30</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 备份目录</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">backup_dir</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=/</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">date</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">/</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">mysql</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">/</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">backup</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 邮箱地址</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">email_address</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">xxxxx</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">@</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">mail.qq</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## MySQL账号</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">mysql_user</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">root</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## MySQL密码</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">mysql_password</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">root1234</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 获取当前日期</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">date_str</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit\\">`date </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit\\">+%</span><span style=\\"--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit\\">Y</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit\\">-%</span><span style=\\"--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit\\">m</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit\\">-%</span><span style=\\"--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit\\">d`</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 备份文件名</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">if</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> [[ </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">z </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$table_name\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> ]]; then</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    backup_file_name</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{database_name}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">_$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{date_str}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">.sql\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">else</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    backup_file_name</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{database_name}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">_$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{table_name}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">_$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{date_str}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">.sql\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">fi</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 压缩后备份文件名</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">if</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> [[ </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">z </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$table_name\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> ]]; then</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    compressed_backup_file_name</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{database_name}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">_$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{date_str}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">.tar.gz\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">else</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    compressed_backup_file_name</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{database_name}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">_$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{table_name}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">_$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{date_str}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">.tar.gz\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">fi</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 备份文件路径</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">backup_file_path</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{backup_dir}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">/$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{backup_file_name}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 压缩后备份文件路径</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">compressed_backup_file_path</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{backup_dir}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">/$</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">{compressed_backup_file_name}</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 检查备份目录是否存在，如果不存在则创建</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">if</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> [[ ! </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">d </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$backup_dir\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> ]]; then</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    mkdir </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">p </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$backup_dir\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">fi</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 备份MySQL数据表</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">if</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> [[ </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">z </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$table_name\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> ]]; then</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    mysqldump </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">u</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$mysql_user\\"</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\"> -</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">p</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$mysql_password\\"</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\"$database_name\\"</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\"> &gt;</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\"$backup_file_path\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">else</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    mysqldump </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">u</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$mysql_user\\"</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\"> -</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">p</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$mysql_password\\"</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\"$database_name\\"</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\"$table_name\\"</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\"> &gt;</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\"$backup_file_path\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">fi</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 压缩备份文件</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">tar </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">czvf </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$compressed_backup_file_path\\"</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\"$backup_file_path\\"</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 删除备份文件</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">rm </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">f </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$backup_file_path\\"</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 检查备份结果</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">if</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> [[ </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">f </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$compressed_backup_file_path\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> ]]; then</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    echo </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"备份成功！\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    echo </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"备份文件路径：$compressed_backup_file_path\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    subject</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"MySQL备份成功\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    body</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"MySQL备份成功，备份文件路径：$compressed_backup_file_path\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">else</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    echo </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"备份失败！\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    subject</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"MySQL备份失败\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">    body</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"MySQL备份失败！\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">fi</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 发送备份结果到指定邮箱</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">echo </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$body\\"</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\"> |</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> mail </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">-</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">s </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$subject\\"</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\"$email_address\\"</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">## 删除过期备份文件</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">find </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$backup_dir\\"</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\"> -</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">mtime </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">+</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"$backup_period\\"</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\"> -</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">name </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"*.tar.gz\\"</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\"> -</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\\">exec</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> rm {} \\\\</span><span style=\\"--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit\\">;</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{y as comp,g as data};
