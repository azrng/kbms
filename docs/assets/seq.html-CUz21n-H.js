import{_ as o}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as p,o as c,c as l,b as n,e as s,f as t,d as e}from"./app-CBxp4zeL.js";const i={},u=n("h2",{id:"概述",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#概述"},[n("span",null,"概述")])],-1),r={href:"https://datalust.co/seq",target:"_blank",rel:"noopener noreferrer"},d={href:"https://datalust.co/seq",target:"_blank",rel:"noopener noreferrer"},k={href:"https://docs.datalust.co/docs",target:"_blank",rel:"noopener noreferrer"},m=e(`<h2 id="支持组件" tabindex="-1"><a class="header-anchor" href="#支持组件"><span>支持组件</span></a></h2><ul><li>Serilog</li><li>Microsoft.Extensions.Logging</li><li>NLog</li><li>log4Net</li></ul><h2 id="操作" tabindex="-1"><a class="header-anchor" href="#操作"><span>操作</span></a></h2><h3 id="serilog对接" tabindex="-1"><a class="header-anchor" href="#serilog对接"><span>Serilog对接</span></a></h3><p>安装nuget包</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token operator">&lt;</span><span class="token class-name">PackageReference</span> Include<span class="token operator">=</span><span class="token string">&quot;Serilog.AspNetCore&quot;</span> Version<span class="token operator">=</span><span class="token string">&quot;8.0.0&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token class-name">PackageReference</span> Include<span class="token operator">=</span><span class="token string">&quot;Serilog.Sinks.Seq&quot;</span> Version<span class="token operator">=</span><span class="token string">&quot;6.0.0&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>配置我们的appsettings.Development.json文件以使用 Seq 接收器</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;Serilog&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;Using&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;Serilog.Sinks.Console&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Serilog.Sinks.File&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;MinimumLevel&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;Default&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Information&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;Override&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;Microsoft&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Warning&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;System&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Warning&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;WriteTo&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> <span class="token string">&quot;Name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Console&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;Name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;File&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Args&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;path&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;./logs/log-.txt&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;rollingInterval&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Day&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;rollOnFileSizeLimit&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token string">&quot;formatter&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Serilog.Formatting.Compact.CompactJsonFormatter, Serilog.Formatting.Compact&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 新增了这一节</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;Name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Seq&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Args&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;serverUrl&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;http://localhost:5341&quot;</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Enrich&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;FromLogContext&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WithMachineName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WithThreadId&quot;</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;AllowedHosts&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在Program中使用配置</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>builder<span class="token punctuation">.</span>Host<span class="token punctuation">.</span><span class="token function">UseSerilog</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> config<span class="token punctuation">.</span>ReadFrom<span class="token punctuation">.</span><span class="token function">Configuration</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span>Configuration<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>或者使用硬编码配置方案</p><div class="language-c# line-numbers-mode" data-ext="c#" data-title="c#"><pre class="language-c#"><code>Log.Logger = new LoggerConfiguration()
                .MinimumLevel.Debug()
				.Enrich.FromLogContext() // 注册日志上下文
                .WriteTo.Console(new CompactJsonFormatter()) // 输出到控制台
                .WriteTo.Seq(&quot;http://localhost:5341/&quot;)
                .CreateLogger();
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="借助opentelemetry使logger输出seq" tabindex="-1"><a class="header-anchor" href="#借助opentelemetry使logger输出seq"><span>借助OpenTelemetry使Logger输出Seq</span></a></h3>`,13),g={href:"https://docs.datalust.co/docs/ingestion-with-opentelemetry",target:"_blank",rel:"noopener noreferrer"},v={href:"https://docs.datalust.co/docs/opentelemetry-net-sdk",target:"_blank",rel:"noopener noreferrer"},b=e(`<p>此处只用来演示对接OpenTelemetry的logs效果，需要安装nuget包</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>还没搞好</p></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ItemGroup</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>OpenTelemetry.Exporter.OpenTelemetryProtocol<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.8.1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>OpenTelemetry.Extensions.Hosting<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.8.1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>OpenTelemetry.Instrumentation.AspNetCore<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.8.1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ItemGroup</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>builder<span class="token punctuation">.</span>Services<span class="token punctuation">.</span><span class="token function">AddLogging</span><span class="token punctuation">(</span>logging <span class="token operator">=&gt;</span> logging<span class="token punctuation">.</span><span class="token function">AddOpenTelemetry</span><span class="token punctuation">(</span>options <span class="token operator">=&gt;</span>
<span class="token punctuation">{</span>
    options<span class="token punctuation">.</span><span class="token function">SetResourceBuilder</span><span class="token punctuation">(</span>ResourceBuilder<span class="token punctuation">.</span><span class="token function">CreateEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                              <span class="token punctuation">.</span><span class="token function">AddService</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span>Environment<span class="token punctuation">.</span>ApplicationName<span class="token punctuation">)</span> <span class="token comment">// 设置服务名</span>
                                              <span class="token punctuation">.</span><span class="token function">AddAttributes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">object</span><span class="token punctuation">&gt;</span></span>
                                                             <span class="token punctuation">{</span>
                                                                 <span class="token comment">// 添加资源属性</span>
                                                                 <span class="token punctuation">[</span><span class="token string">&quot;deployment.environment&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;development&quot;</span>
                                                             <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Some important options to improve data quality</span>
    options<span class="token punctuation">.</span>IncludeScopes <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    options<span class="token punctuation">.</span>IncludeFormattedMessage <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    options<span class="token punctuation">.</span><span class="token function">AddOtlpExporter</span><span class="token punctuation">(</span>exporter <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        exporter<span class="token punctuation">.</span>Protocol <span class="token operator">=</span> OtlpExportProtocol<span class="token punctuation">.</span>HttpProtobuf<span class="token punctuation">;</span>
        exporter<span class="token punctuation">.</span>Endpoint <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Uri</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:5341/ingest/otlp/v1/logs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        exporter<span class="token punctuation">.</span>Headers <span class="token operator">=</span> <span class="token string">&quot;X-Seq-ApiKey=12345678901234567890&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 配置apiKey</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h2><p>我们通常在 docker 中启动 Seq 作为单独的 docker-compose 文件 ( docker-compose-logging.hml) 的一部分</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>version<span class="token punctuation">:</span> &#39;<span class="token number">3.4</span>&#39;

services<span class="token punctuation">:</span>
  seq<span class="token punctuation">:</span>
    image<span class="token punctuation">:</span> datalust<span class="token operator">/</span>seq<span class="token punctuation">:</span><span class="token class-name">latest</span>
    container_name<span class="token punctuation">:</span> <span class="token class-name">seq</span>
    environment<span class="token punctuation">:</span>
      <span class="token operator">-</span> ACCEPT_EULA<span class="token operator">=</span><span class="token class-name">Y</span>
    ports<span class="token punctuation">:</span>
      <span class="token operator">-</span> <span class="token number">5341</span><span class="token punctuation">:</span><span class="token number">5341</span>
      <span class="token operator">-</span> <span class="token number">8081</span><span class="token punctuation">:</span><span class="token number">80</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>docker命令</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>docker run  <span class="token operator">--</span>name seq <span class="token operator">-</span>d <span class="token operator">-</span><span class="token class-name">e</span> ACCEPT_EULA<span class="token operator">=</span>Y <span class="token operator">-</span>p <span class="token number">8081</span><span class="token punctuation">:</span><span class="token number">80</span> <span class="token operator">-</span>p <span class="token number">5341</span><span class="token punctuation">:</span><span class="token number">5341</span> datalust<span class="token operator">/</span>seq
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,9);function q(h,f){const a=p("ExternalLinkIcon");return c(),l("div",null,[u,n("p",null,[n("a",r,[s("Seq"),t(a)]),s(" 是为结构化日志数据构建的自托管搜索、分析和警报服务器。 它可以免费用于本地开发。 它为结构化日志数据提供高级搜索和过滤功能。 官网："),n("a",d,[s("https://datalust.co/seq"),t(a)]),s(" 文档："),n("a",k,[s("https://docs.datalust.co/docs"),t(a)])]),m,n("p",null,[s("从OpenTelemetry引入日志记录："),n("a",g,[s("https://docs.datalust.co/docs/ingestion-with-opentelemetry"),t(a)])]),n("p",null,[s("OpenTelemetry使用文档："),n("a",v,[s("https://docs.datalust.co/docs/opentelemetry-net-sdk"),t(a)])]),b])}const S=o(i,[["render",q],["__file","seq.html.vue"]]),x=JSON.parse('{"path":"/middleware/smallService/distributedObservability/distributedLogger/seq.html","title":"Seq","lang":"zh-CN","frontmatter":{"title":"Seq","lang":"zh-CN","date":"2023-07-27T00:00:00.000Z","publish":true,"author":"azrng","isOriginal":true,"category":["middleware"],"tag":["无"],"filename":"seq","slug":"xz72rx","docsId":"73442318","description":"概述 Seq 是为结构化日志数据构建的自托管搜索、分析和警报服务器。 它可以免费用于本地开发。 它为结构化日志数据提供高级搜索和过滤功能。 官网：https://datalust.co/seq 文档：https://docs.datalust.co/docs 支持组件 Serilog Microsoft.Extensions.Logging NLog ...","head":[["meta",{"property":"og:url","content":"https://azrng.gitee.io/kbms/kbms/middleware/smallService/distributedObservability/distributedLogger/seq.html"}],["meta",{"property":"og:site_name","content":"知识库"}],["meta",{"property":"og:title","content":"Seq"}],["meta",{"property":"og:description","content":"概述 Seq 是为结构化日志数据构建的自托管搜索、分析和警报服务器。 它可以免费用于本地开发。 它为结构化日志数据提供高级搜索和过滤功能。 官网：https://datalust.co/seq 文档：https://docs.datalust.co/docs 支持组件 Serilog Microsoft.Extensions.Logging NLog ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-15T15:11:04.000Z"}],["meta",{"property":"article:author","content":"azrng"}],["meta",{"property":"article:tag","content":"无"}],["meta",{"property":"article:published_time","content":"2023-07-27T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-05-15T15:11:04.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Seq\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-07-27T00:00:00.000Z\\",\\"dateModified\\":\\"2024-05-15T15:11:04.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"azrng\\"}]}"]]},"headers":[{"level":2,"title":"概述","slug":"概述","link":"#概述","children":[]},{"level":2,"title":"支持组件","slug":"支持组件","link":"#支持组件","children":[]},{"level":2,"title":"操作","slug":"操作","link":"#操作","children":[{"level":3,"title":"Serilog对接","slug":"serilog对接","link":"#serilog对接","children":[]},{"level":3,"title":"借助OpenTelemetry使Logger输出Seq","slug":"借助opentelemetry使logger输出seq","link":"#借助opentelemetry使logger输出seq","children":[]}]},{"level":2,"title":"安装","slug":"安装","link":"#安装","children":[]}],"git":{"createdTime":1697724028000,"updatedTime":1715785864000,"contributors":[{"name":"azrng","email":"itzhangyunpeng@163.com","commits":2},{"name":"zhangyunpeng","email":"zhang.yunpeng@synyi.com","commits":1}]},"readingTime":{"minutes":1.51,"words":452},"filePathRelative":"middleware/smallService/distributedObservability/distributedLogger/seq.md","localizedDate":"2023年7月27日","excerpt":"<h2>概述</h2>\\n<p><a href=\\"https://datalust.co/seq\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Seq</a> 是为结构化日志数据构建的自托管搜索、分析和警报服务器。 它可以免费用于本地开发。 它为结构化日志数据提供高级搜索和过滤功能。\\n官网：<a href=\\"https://datalust.co/seq\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://datalust.co/seq</a>\\n文档：<a href=\\"https://docs.datalust.co/docs\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://docs.datalust.co/docs</a></p>","autoDesc":true}');export{S as comp,x as data};
