import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as p,o,c,b as n,e as s,f as t,d as l}from"./app-Bfb6-vFH.js";const i={},u=l(`<blockquote><p>本文示例代码环境：vs2019+.Net5</p></blockquote><h2 id="_1-优点" tabindex="-1"><a class="header-anchor" href="#_1-优点"><span>1. 优点</span></a></h2><ol><li>有助于保护原有系统，不受影响，并及时修改问题</li><li>可以实现用户的私人定制（比如是付费接口）</li><li>快速迭代</li></ol><h2 id="_2-api版本控制" tabindex="-1"><a class="header-anchor" href="#_2-api版本控制"><span>2. API版本控制</span></a></h2><ul><li>在URL中追加版本或者作为查询字符串参数</li><li>通过自动以标头和通过接受标头</li></ul><h3 id="_2-1-安装组件" tabindex="-1"><a class="header-anchor" href="#_2-1-安装组件"><span>2.1 安装组件</span></a></h3><p>ASP.NET API versioning为您提供了一种功能强大但易于使用的方法，用于将API版本控制语义添加到使用ASP.NET构建的新的和现有的REST服务中。API版本控制扩展定义了简单的元数据属性和约定，用于描述您的服务实现了哪些API版本。</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token operator">&lt;</span><span class="token class-name">PackageReference</span> Include<span class="token operator">=</span><span class="token string">&quot;Microsoft.AspNetCore.Mvc.Versioning&quot;</span> Version<span class="token operator">=</span><span class="token string">&quot;4.2.0&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token class-name">PackageReference</span> Include<span class="token operator">=</span><span class="token string">&quot;Microsoft.AspNetCore.Mvc.Versioning.ApiExplorer&quot;</span> Version<span class="token operator">=</span><span class="token string">&quot;4.2.0&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-1-1-常用配置" tabindex="-1"><a class="header-anchor" href="#_2-1-1-常用配置"><span>2.1.1 常用配置</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;1.1&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span> <span class="token comment">//设置版本号</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersionNeutral</span></span><span class="token punctuation">]</span><span class="token comment">//退出版本控制</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MapToApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;1.1&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span> <span class="token comment">//设置独立版本</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;1.0&quot;</span><span class="token punctuation">,</span> Deprecated <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token comment">//api版本已经被弃用</span>
HttpContext<span class="token punctuation">.</span><span class="token function">GetRequestedApiVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//访问版本信息 </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-querystring来实现版本控制" tabindex="-1"><a class="header-anchor" href="#_2-2-querystring来实现版本控制"><span>2.2 QueryString来实现版本控制</span></a></h3><h4 id="_2-2-1-configureservices中配置" tabindex="-1"><a class="header-anchor" href="#_2-2-1-configureservices中配置"><span>2.2.1 ConfigureServices中配置</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token comment">//Versioning用来实现API的版本控制</span>
services<span class="token punctuation">.</span><span class="token function">AddApiVersioning</span><span class="token punctuation">(</span>options <span class="token operator">=&gt;</span>
<span class="token punctuation">{</span>
    options<span class="token punctuation">.</span>DefaultApiVersion <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ApiVersion</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//默认版本号</span>
    options<span class="token punctuation">.</span>AssumeDefaultVersionWhenUnspecified <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//此选项将用于不提供版本的请求，默认情况下假定API的版本为1.0</span>
    options<span class="token punctuation">.</span>ReportApiVersions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//当设置为true时候，api将返回响应标头中支持的版本信息</span>
    <span class="token comment">//下面这句默认不写也可以</span>
    <span class="token comment">//options.ApiVersionReader = new QueryStringApiVersionReader(parameterNames: &quot;api-version&quot;);//该名称用于查询时候使用</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-2-2-控制器设置版本" tabindex="-1"><a class="header-anchor" href="#_2-2-2-控制器设置版本"><span>2.2.2 控制器设置版本</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">namespace</span> <span class="token namespace">NetCore_SwaggerVersion<span class="token punctuation">.</span>Controllers<span class="token punctuation">.</span>v1</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// 版本1.1</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token punctuation">[</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token string">&quot;api/[controller]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiController</span></span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;1.1&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token comment">//可以设置多个</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;1.2&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">:</span> ControllerBase
    
<span class="token keyword">namespace</span> <span class="token namespace">NetCore_SwaggerVersion<span class="token punctuation">.</span>Controllers<span class="token punctuation">.</span>v2</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// 版本2.0</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token punctuation">[</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token string">&quot;api/[controller]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiController</span></span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;2.6&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ControllerBase</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>不同命名空间下可以存在相同的控制器</p></blockquote><h4 id="_2-2-3-特定方法设置版本" tabindex="-1"><a class="header-anchor" href="#_2-2-3-特定方法设置版本"><span>2.2.3 特定方法设置版本</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MapToApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;1.1&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-2-4-设置不受版本控制" tabindex="-1"><a class="header-anchor" href="#_2-2-4-设置不受版本控制"><span>2.2.4 设置不受版本控制</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersionNeutral</span></span><span class="token punctuation">]</span><span class="token comment">//退出版本控制</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiController</span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;api/[controller]/[action]&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
 <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WeatherForecastController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ControllerBase</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3-5-访问地址" tabindex="-1"><a class="header-anchor" href="#_2-3-5-访问地址"><span>2.3.5 访问地址</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">5000</span><span class="token operator">/</span>api<span class="token operator">/</span>WeatherForecast<span class="token operator">/</span>Get <span class="token comment">//不写版本号的话走的是默认的版本号</span>
http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">5000</span><span class="token operator">/</span>api<span class="token operator">/</span>Test<span class="token punctuation">?</span>api<span class="token operator">-</span>version<span class="token operator">=</span><span class="token number">1.1</span>
http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">5000</span><span class="token operator">/</span>api<span class="token operator">/</span>Test<span class="token punctuation">?</span>api<span class="token operator">-</span>version<span class="token operator">=</span><span class="token number">1.2</span>
http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">5000</span><span class="token operator">/</span>api<span class="token operator">/</span>Test<span class="token punctuation">?</span>api<span class="token operator">-</span>version<span class="token operator">=</span><span class="token number">2.6</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-url-path-segment来实现版本控制" tabindex="-1"><a class="header-anchor" href="#_2-3-url-path-segment来实现版本控制"><span>2.3 URL Path Segment来实现版本控制</span></a></h3><h4 id="_2-3-1-configureservices中配置" tabindex="-1"><a class="header-anchor" href="#_2-3-1-configureservices中配置"><span>2.3.1 ConfigureServices中配置</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token comment">//Versioning用来实现API的版本控制</span>
services<span class="token punctuation">.</span><span class="token function">AddApiVersioning</span><span class="token punctuation">(</span>options <span class="token operator">=&gt;</span>
<span class="token punctuation">{</span>
    options<span class="token punctuation">.</span>DefaultApiVersion <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ApiVersion</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//默认版本号</span>
    options<span class="token punctuation">.</span>AssumeDefaultVersionWhenUnspecified <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//此选项将用于不提供版本的请求，默认情况下假定API的版本为1.0</span>
    options<span class="token punctuation">.</span>ReportApiVersions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//当设置为true时候，api将返回响应标头中支持的版本信息</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3-2-控制器设置版本" tabindex="-1"><a class="header-anchor" href="#_2-3-2-控制器设置版本"><span>2.3.2 控制器设置版本</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">namespace</span> <span class="token namespace">NetCore_SwaggerVersion<span class="token punctuation">.</span>Controllers<span class="token punctuation">.</span>v1</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// 版本1.1</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token punctuation">[</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token string">&quot;api/v{version:apiVersion}/[controller]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiController</span></span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;1.0&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;1.1&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token comment">//定义控制器提供哪个版本的API</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">:</span> ControllerBase
    
<span class="token keyword">namespace</span> <span class="token namespace">NetCore_SwaggerVersion<span class="token punctuation">.</span>Controllers<span class="token punctuation">.</span>v2</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// 版本2.0</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token punctuation">[</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token string">&quot;api/v{version:apiVersion}/[controller]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiController</span></span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;2.6&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ControllerBase</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>不同命名空间下可以存在相同的控制器</p></blockquote><h4 id="_2-3-3-特定方法设置版本" tabindex="-1"><a class="header-anchor" href="#_2-3-3-特定方法设置版本"><span>2.3.3 特定方法设置版本</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MapToApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;1.1&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3-4-设置不受版本控制" tabindex="-1"><a class="header-anchor" href="#_2-3-4-设置不受版本控制"><span>2.3.4 设置不受版本控制</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersionNeutral</span></span><span class="token punctuation">]</span><span class="token comment">//退出版本控制</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiController</span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;api/[controller]/[action]&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WeatherForecastController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ControllerBase</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3-5-访问地址-1" tabindex="-1"><a class="header-anchor" href="#_2-3-5-访问地址-1"><span>2.3.5 访问地址</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">5000</span><span class="token operator">/</span>api<span class="token operator">/</span>v1<span class="token punctuation">.</span><span class="token number">0</span><span class="token operator">/</span><span class="token class-name">Test</span>
http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">5000</span><span class="token operator">/</span>api<span class="token operator">/</span>v1<span class="token punctuation">.</span><span class="token number">1</span><span class="token operator">/</span><span class="token class-name">Test</span>
http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">5000</span><span class="token operator">/</span>api<span class="token operator">/</span>v2<span class="token punctuation">.</span><span class="token number">6</span><span class="token operator">/</span><span class="token class-name">Test</span>
http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">5000</span><span class="token operator">/</span>api<span class="token operator">/</span>WeatherForecast<span class="token operator">/</span>Get 不受版本控制
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-http-headers来实现版本控制" tabindex="-1"><a class="header-anchor" href="#_2-4-http-headers来实现版本控制"><span>2.4 HTTP Headers来实现版本控制</span></a></h3><h4 id="_2-4-1-configureservices中配置" tabindex="-1"><a class="header-anchor" href="#_2-4-1-configureservices中配置"><span>2.4.1 ConfigureServices中配置</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token comment">//Versioning用来实现API的版本控制</span>
services<span class="token punctuation">.</span><span class="token function">AddApiVersioning</span><span class="token punctuation">(</span>options <span class="token operator">=&gt;</span>
<span class="token punctuation">{</span>
    options<span class="token punctuation">.</span>DefaultApiVersion <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ApiVersion</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//默认版本号</span>
    options<span class="token punctuation">.</span>AssumeDefaultVersionWhenUnspecified <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//此选项将用于不提供版本的请求，默认情况下假定API的版本为1.0</span>
    options<span class="token punctuation">.</span>ReportApiVersions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//当设置为true时候，api将返回响应标头中支持的版本信息</span>
    <span class="token comment">//header传递版本信息</span>
    options<span class="token punctuation">.</span>ApiVersionReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HeaderApiVersionReader</span><span class="token punctuation">(</span><span class="token string">&quot;version&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    options<span class="token punctuation">.</span>ApiVersionSelector <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">CurrentImplementationApiVersionSelector</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//如果没有传输版本号，那么会使用最大版本号  LowestImplementedApiVersionSelector是最小版本号</span>
    options<span class="token punctuation">.</span>UseApiBehavior <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//是否使用API行为</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4-2-控制器设置版本" tabindex="-1"><a class="header-anchor" href="#_2-4-2-控制器设置版本"><span>2.4.2 控制器设置版本</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">namespace</span> <span class="token namespace">NetCore_SwaggerVersion<span class="token punctuation">.</span>Controllers<span class="token punctuation">.</span>v1</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// 版本1.1</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token punctuation">[</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token string">&quot;api/[controller]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiController</span></span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;1.1&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token comment">//定义控制器提供哪个版本的API</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">:</span> ControllerBase
    
<span class="token keyword">namespace</span> <span class="token namespace">NetCore_SwaggerVersion<span class="token punctuation">.</span>Controllers<span class="token punctuation">.</span>v2</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// 版本2.0</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token punctuation">[</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token string">&quot;api/[controller]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiController</span></span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;2.6&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ControllerBase</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>不同命名空间下可以存在相同的控制器</p></blockquote><h4 id="_2-4-3-特定方法设置版本" tabindex="-1"><a class="header-anchor" href="#_2-4-3-特定方法设置版本"><span>2.4.3 特定方法设置版本</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MapToApiVersion</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;1.1&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4-4-设置不受版本控制" tabindex="-1"><a class="header-anchor" href="#_2-4-4-设置不受版本控制"><span>2.4.4 设置不受版本控制</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiVersionNeutral</span></span><span class="token punctuation">]</span><span class="token comment">//退出版本控制</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ApiController</span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;api/[controller]/[action]&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WeatherForecastController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ControllerBase</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4-5-访问地址" tabindex="-1"><a class="header-anchor" href="#_2-4-5-访问地址"><span>2.4.5 访问地址</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">5000</span><span class="token operator">/</span>api<span class="token operator">/</span>Test  <span class="token comment">//需要在headers里面增加 version: 1.1</span>
http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">5000</span><span class="token operator">/</span>api<span class="token operator">/</span>WeatherForecast<span class="token operator">/</span>Get 不受版本控制
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-5-同时支持多种模式" tabindex="-1"><a class="header-anchor" href="#_2-5-同时支持多种模式"><span>2.5 同时支持多种模式</span></a></h3><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>services<span class="token punctuation">.</span><span class="token function">AddApiVersioning</span><span class="token punctuation">(</span>o <span class="token operator">=&gt;</span>
<span class="token punctuation">{</span>
    o<span class="token punctuation">.</span>ReportApiVersions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>AssumeDefaultVersionWhenUnspecified <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>DefaultApiVersion <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ApiVersion</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>ApiVersionReader <span class="token operator">=</span> ApiVersionReader<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">HeaderApiVersionReader</span><span class="token punctuation">(</span><span class="token string">&quot;api-version&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryStringApiVersionReader</span><span class="token punctuation">(</span><span class="token string">&quot;api-version&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//或者</span>
    <span class="token comment">//同时支持查询字符串和标头</span>
    o<span class="token punctuation">.</span>ApiVersionReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryStringOrHeaderApiVersionReader</span><span class="token punctuation">(</span><span class="token named-parameter punctuation">parameterName</span><span class="token punctuation">:</span> <span class="token string">&quot;version&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>HeaderNames <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;api-version&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x-ms-version&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-6-不借助包-封装文件" tabindex="-1"><a class="header-anchor" href="#_2-6-不借助包-封装文件"><span>2.6 不借助包，封装文件</span></a></h3><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NameSpaceVersionRoutingConvention</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IApplicationModelConvention</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name"><span class="token keyword">string</span></span> apiPrefix<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> urlTemplate <span class="token operator">=</span> <span class="token string">&quot;{0}/{1}/{2}&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">NameSpaceVersionRoutingConvention</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> apiPrefix <span class="token operator">=</span> <span class="token string">&quot;api&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>apiPrefix <span class="token operator">=</span> apiPrefix<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Apply</span><span class="token punctuation">(</span><span class="token class-name">ApplicationModel</span> application<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> controller <span class="token keyword">in</span> application<span class="token punctuation">.</span>Controllers<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>

            <span class="token class-name"><span class="token keyword">var</span></span> hasRouteAttribute <span class="token operator">=</span> controller<span class="token punctuation">.</span>Selectors
            <span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>AttributeRouteModel <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>hasRouteAttribute<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name"><span class="token keyword">var</span></span> nameSpaces <span class="token operator">=</span> controller<span class="token punctuation">.</span>ControllerType<span class="token punctuation">.</span>Namespace<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token char">&#39;.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//获取namespace中版本号部分</span>
            <span class="token class-name"><span class="token keyword">var</span></span> version <span class="token operator">=</span> nameSpaces<span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> Regex<span class="token punctuation">.</span><span class="token function">IsMatch</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">@&quot;^v(\\d+)$&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>version<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name"><span class="token keyword">string</span></span> template <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>urlTemplate<span class="token punctuation">,</span> apiPrefix<span class="token punctuation">,</span> version<span class="token punctuation">,</span>
            controller<span class="token punctuation">.</span>ControllerName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            controller<span class="token punctuation">.</span>Selectors<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>AttributeRouteModel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AttributeRouteModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Template <span class="token operator">=</span> template
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>调试代码发现这种方式只在程序第一次运行的时候会执行，之后不会再执行多次，因此效率很高。</p>`,51),r={href:"https://www.cnblogs.com/runningsmallguo/p/7484954.html",target:"_blank",rel:"noopener noreferrer"},k=n("h2",{id:"参考文档",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#参考文档"},[n("span",null,"参考文档")])],-1),d={href:"https://github.com/microsoft/aspnet-api-versioning",target:"_blank",rel:"noopener noreferrer"};function m(v,b){const a=p("ExternalLinkIcon");return o(),c("div",null,[u,n("blockquote",null,[n("p",null,[s("借鉴于："),n("a",r,[s("https://www.cnblogs.com/runningsmallguo/p/7484954.html"),t(a)])])]),k,n("blockquote",null,[n("p",null,[n("a",d,[s("https://github.com/microsoft/aspnet-api-versioning"),t(a)])])])])}const _=e(i,[["render",m],["__file","banbenkongzhi.html.vue"]]),y=JSON.parse('{"path":"/dotnet/api/controllerApi/banbenkongzhi.html","title":"版本控制","lang":"zh-CN","frontmatter":{"title":"版本控制","lang":"zh-CN","date":"2022-01-14T00:00:00.000Z","publish":true,"author":"azrng","isOriginal":true,"category":["dotNET"],"tag":["无"],"filename":"banbenkongzhi","slug":"uuuigo","docsId":"30622258","description":"本文示例代码环境：vs2019+.Net5 1. 优点 有助于保护原有系统，不受影响，并及时修改问题 可以实现用户的私人定制（比如是付费接口） 快速迭代 2. API版本控制 在URL中追加版本或者作为查询字符串参数 通过自动以标头和通过接受标头 2.1 安装组件 ASP.NET API versioning为您提供了一种功能强大但易于使用的方法，用于...","head":[["meta",{"property":"og:url","content":"https://azrng.gitee.io/kbms/kbms/dotnet/api/controllerApi/banbenkongzhi.html"}],["meta",{"property":"og:site_name","content":"知识库"}],["meta",{"property":"og:title","content":"版本控制"}],["meta",{"property":"og:description","content":"本文示例代码环境：vs2019+.Net5 1. 优点 有助于保护原有系统，不受影响，并及时修改问题 可以实现用户的私人定制（比如是付费接口） 快速迭代 2. API版本控制 在URL中追加版本或者作为查询字符串参数 通过自动以标头和通过接受标头 2.1 安装组件 ASP.NET API versioning为您提供了一种功能强大但易于使用的方法，用于..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-02-25T09:26:24.000Z"}],["meta",{"property":"article:author","content":"azrng"}],["meta",{"property":"article:tag","content":"无"}],["meta",{"property":"article:published_time","content":"2022-01-14T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-02-25T09:26:24.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"版本控制\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-01-14T00:00:00.000Z\\",\\"dateModified\\":\\"2024-02-25T09:26:24.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"azrng\\"}]}"]]},"headers":[{"level":2,"title":"1. 优点","slug":"_1-优点","link":"#_1-优点","children":[]},{"level":2,"title":"2. API版本控制","slug":"_2-api版本控制","link":"#_2-api版本控制","children":[{"level":3,"title":"2.1 安装组件","slug":"_2-1-安装组件","link":"#_2-1-安装组件","children":[{"level":4,"title":"2.1.1 常用配置","slug":"_2-1-1-常用配置","link":"#_2-1-1-常用配置","children":[]}]},{"level":3,"title":"2.2 QueryString来实现版本控制","slug":"_2-2-querystring来实现版本控制","link":"#_2-2-querystring来实现版本控制","children":[{"level":4,"title":"2.2.1 ConfigureServices中配置","slug":"_2-2-1-configureservices中配置","link":"#_2-2-1-configureservices中配置","children":[]},{"level":4,"title":"2.2.2 控制器设置版本","slug":"_2-2-2-控制器设置版本","link":"#_2-2-2-控制器设置版本","children":[]},{"level":4,"title":"2.2.3 特定方法设置版本","slug":"_2-2-3-特定方法设置版本","link":"#_2-2-3-特定方法设置版本","children":[]},{"level":4,"title":"2.2.4 设置不受版本控制","slug":"_2-2-4-设置不受版本控制","link":"#_2-2-4-设置不受版本控制","children":[]},{"level":4,"title":"2.3.5 访问地址","slug":"_2-3-5-访问地址","link":"#_2-3-5-访问地址","children":[]}]},{"level":3,"title":"2.3 URL Path Segment来实现版本控制","slug":"_2-3-url-path-segment来实现版本控制","link":"#_2-3-url-path-segment来实现版本控制","children":[{"level":4,"title":"2.3.1 ConfigureServices中配置","slug":"_2-3-1-configureservices中配置","link":"#_2-3-1-configureservices中配置","children":[]},{"level":4,"title":"2.3.2 控制器设置版本","slug":"_2-3-2-控制器设置版本","link":"#_2-3-2-控制器设置版本","children":[]},{"level":4,"title":"2.3.3 特定方法设置版本","slug":"_2-3-3-特定方法设置版本","link":"#_2-3-3-特定方法设置版本","children":[]},{"level":4,"title":"2.3.4 设置不受版本控制","slug":"_2-3-4-设置不受版本控制","link":"#_2-3-4-设置不受版本控制","children":[]},{"level":4,"title":"2.3.5 访问地址","slug":"_2-3-5-访问地址-1","link":"#_2-3-5-访问地址-1","children":[]}]},{"level":3,"title":"2.4 HTTP Headers来实现版本控制","slug":"_2-4-http-headers来实现版本控制","link":"#_2-4-http-headers来实现版本控制","children":[{"level":4,"title":"2.4.1 ConfigureServices中配置","slug":"_2-4-1-configureservices中配置","link":"#_2-4-1-configureservices中配置","children":[]},{"level":4,"title":"2.4.2 控制器设置版本","slug":"_2-4-2-控制器设置版本","link":"#_2-4-2-控制器设置版本","children":[]},{"level":4,"title":"2.4.3 特定方法设置版本","slug":"_2-4-3-特定方法设置版本","link":"#_2-4-3-特定方法设置版本","children":[]},{"level":4,"title":"2.4.4 设置不受版本控制","slug":"_2-4-4-设置不受版本控制","link":"#_2-4-4-设置不受版本控制","children":[]},{"level":4,"title":"2.4.5 访问地址","slug":"_2-4-5-访问地址","link":"#_2-4-5-访问地址","children":[]}]},{"level":3,"title":"2.5 同时支持多种模式","slug":"_2-5-同时支持多种模式","link":"#_2-5-同时支持多种模式","children":[]},{"level":3,"title":"2.6 不借助包，封装文件","slug":"_2-6-不借助包-封装文件","link":"#_2-6-不借助包-封装文件","children":[]}]},{"level":2,"title":"参考文档","slug":"参考文档","link":"#参考文档","children":[]}],"git":{"createdTime":1697962303000,"updatedTime":1708853184000,"contributors":[{"name":"azrng","email":"itzhangyunpeng@163.com","commits":1}]},"readingTime":{"minutes":4.46,"words":1339},"filePathRelative":"dotnet/api/controllerApi/banbenkongzhi.md","localizedDate":"2022年1月14日","excerpt":"<blockquote>\\n<p>本文示例代码环境：vs2019+.Net5</p>\\n</blockquote>\\n<h2>1. 优点</h2>\\n<ol>\\n<li>有助于保护原有系统，不受影响，并及时修改问题</li>\\n<li>可以实现用户的私人定制（比如是付费接口）</li>\\n<li>快速迭代</li>\\n</ol>\\n<h2>2. API版本控制</h2>\\n<ul>\\n<li>在URL中追加版本或者作为查询字符串参数</li>\\n<li>通过自动以标头和通过接受标头</li>\\n</ul>\\n<h3>2.1 安装组件</h3>\\n<p>ASP.NET API versioning为您提供了一种功能强大但易于使用的方法，用于将API版本控制语义添加到使用ASP.NET构建的新的和现有的REST服务中。API版本控制扩展定义了简单的元数据属性和约定，用于描述您的服务实现了哪些API版本。</p>","autoDesc":true}');export{_ as comp,y as data};
