import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as t,o as e,c as p,b as n,e as o,f as c,d as i}from"./app-D8HBJYTp.js";const l="/kbms/common/1620829882545-2591e49c-b0b0-4edf-850f-62a44d8af05f.png",u={},r=i(`<h2 id="介绍" tabindex="-1"><a class="header-anchor" href="#介绍"><span>介绍</span></a></h2><p>通过一些简单的配置文件配置来决定某一个功能是否开启，方便快捷。</p><blockquote><p>示例环境：vs2019、net5</p></blockquote><h2 id="引用组件包" tabindex="-1"><a class="header-anchor" href="#引用组件包"><span>引用组件包</span></a></h2><blockquote><p>Microsoft.FeatureManagement.AspNetCore</p></blockquote><h3 id="简单使用" tabindex="-1"><a class="header-anchor" href="#简单使用"><span>简单使用</span></a></h3><h4 id="配置文件" tabindex="-1"><a class="header-anchor" href="#配置文件"><span>配置文件</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;Logging&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;LogLevel&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;Default&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Information&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;Microsoft&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Warning&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;Microsoft.Hosting.Lifetime&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Information&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;FeatureManagement&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;ActiveStatus&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;AllowedHosts&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="注入容器" tabindex="-1"><a class="header-anchor" href="#注入容器"><span>注入容器</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            services<span class="token punctuation">.</span><span class="token function">AddControllers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            services<span class="token punctuation">.</span><span class="token function">AddFeatureManagement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="控制器使用" tabindex="-1"><a class="header-anchor" href="#控制器使用"><span>控制器使用</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>        <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">IFeatureManager</span> _featureManager<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token function">HomeController</span><span class="token punctuation">(</span><span class="token class-name">IFeatureManager</span> featureManager<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            _featureManager <span class="token operator">=</span> featureManager<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">await</span> _featureManager<span class="token punctuation">.</span><span class="token function">IsEnabledAsync</span><span class="token punctuation">(</span><span class="token string">&quot;ActiveStatus&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//通过这个if去判断是否执行</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token string">&quot;启用&quot;</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">return</span> <span class="token string">&quot;输出&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>通过这个if去判断是否执行</p></blockquote><figure><img src="`+l+`" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h4 id="对整个控制器or单个action控制" tabindex="-1"><a class="header-anchor" href="#对整个控制器or单个action控制"><span>对整个控制器or单个action控制</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span></span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">FeatureGate</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;ActiveStatus&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//if (await _featureManager.IsEnabledAsync(&quot;FubaoEnabled&quot;))</span>
            <span class="token comment">//{</span>
            <span class="token comment">//    return &quot;启用&quot;;</span>
            <span class="token comment">//}</span>

            <span class="token keyword">return</span> <span class="token string">&quot;输出&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>如果状态改为false，通过http去调用接口提示404</p></blockquote><h3 id="通过时间模式控制" tabindex="-1"><a class="header-anchor" href="#通过时间模式控制"><span>通过时间模式控制</span></a></h3><h4 id="配置文件-1" tabindex="-1"><a class="header-anchor" href="#配置文件-1"><span>配置文件</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token string">&quot;FeatureManagement&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;Fubao&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">//这个配置的名称</span>
      <span class="token string">&quot;EnabledFor&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token string">&quot;Name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;TimeWindow&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;Parameters&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;Start&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;12/05/2020 03:00:00 GMT&quot;</span><span class="token punctuation">,</span> <span class="token comment">//UTC时间起点</span>
            <span class="token string">&quot;End&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;12/05/2020 03:10:00 GMT&quot;</span> <span class="token comment">//UTC时间终点</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="注入容器-1" tabindex="-1"><a class="header-anchor" href="#注入容器-1"><span>注入容器</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>services<span class="token punctuation">.</span><span class="token function">AddFeatureManagement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddFeatureFilter</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TimeWindowFilter<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="控制器使用-1" tabindex="-1"><a class="header-anchor" href="#控制器使用-1"><span>控制器使用</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>        <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">IFeatureManager</span> _featureManager<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token function">HomeController</span><span class="token punctuation">(</span><span class="token class-name">IFeatureManager</span> featureManager<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            _featureManager <span class="token operator">=</span> featureManager<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">await</span> _featureManager<span class="token punctuation">.</span><span class="token function">IsEnabledAsync</span><span class="token punctuation">(</span><span class="token string">&quot;FubaoEnabled&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//通过这个if去判断是否执行</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token string">&quot;启用&quot;</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">return</span> <span class="token string">&quot;输出&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="对整个控制器or单个action控制-1" tabindex="-1"><a class="header-anchor" href="#对整个控制器or单个action控制-1"><span>对整个控制器or单个action控制</span></a></h4><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span></span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">FeatureGate</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;FubaoEnabled&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//if (await _featureManager.IsEnabledAsync(&quot;FubaoEnabled&quot;))</span>
            <span class="token comment">//{</span>
            <span class="token comment">//    return &quot;启用&quot;;</span>
            <span class="token comment">//}</span>

            <span class="token keyword">return</span> <span class="token string">&quot;输出&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>注意： 功能开关的配置值更改，无需重启应用程序，修改配置文件后可以热更新，立即生效！ 由于 TimeWindow 的时间属性是 DateTimeOffset? 类型的，因此我们没法配置具体时区（如中国CST）的时间，必须人工转换为 GMT 时间才行。</p></blockquote><h2 id="参考文档" tabindex="-1"><a class="header-anchor" href="#参考文档"><span>参考文档</span></a></h2>`,28),d={href:"https://github.com/microsoft/FeatureManagement-Dotnet",target:"_blank",rel:"noopener noreferrer"};function k(m,v){const s=t("ExternalLinkIcon");return e(),p("div",null,[r,n("blockquote",null,[n("p",null,[n("a",d,[o("https://github.com/microsoft/FeatureManagement-Dotnet"),c(s)])])])])}const h=a(u,[["render",k],["__file","featuremanagement.html.vue"]]),f=JSON.parse('{"path":"/dotnet/base/peizhikuangjia/peizhikaiguan/featuremanagement.html","title":"FeatureManagement","lang":"zh-CN","frontmatter":{"title":"FeatureManagement","lang":"zh-CN","date":"2023-08-04T00:00:00.000Z","publish":true,"author":"azrng","isOriginal":true,"category":["dotNET"],"tag":["无"],"filename":"featuremanagement","slug":"tdwga0","docsId":"26485839","description":"介绍 通过一些简单的配置文件配置来决定某一个功能是否开启，方便快捷。 示例环境：vs2019、net5 引用组件包 Microsoft.FeatureManagement.AspNetCore 简单使用 配置文件 注入容器 控制器使用 通过这个if去判断是否执行 image.pngimage.png 对整个控制器or单个action控制 如果状态改为f...","head":[["meta",{"property":"og:url","content":"https://azrng.gitee.io/kbms/kbms/dotnet/base/peizhikuangjia/peizhikaiguan/featuremanagement.html"}],["meta",{"property":"og:site_name","content":"知识库"}],["meta",{"property":"og:title","content":"FeatureManagement"}],["meta",{"property":"og:description","content":"介绍 通过一些简单的配置文件配置来决定某一个功能是否开启，方便快捷。 示例环境：vs2019、net5 引用组件包 Microsoft.FeatureManagement.AspNetCore 简单使用 配置文件 注入容器 控制器使用 通过这个if去判断是否执行 image.pngimage.png 对整个控制器or单个action控制 如果状态改为f..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://azrng.gitee.io/kbms/kbms/common/1620829882545-2591e49c-b0b0-4edf-850f-62a44d8af05f.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-10-25T13:23:37.000Z"}],["meta",{"property":"article:author","content":"azrng"}],["meta",{"property":"article:tag","content":"无"}],["meta",{"property":"article:published_time","content":"2023-08-04T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-10-25T13:23:37.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"FeatureManagement\\",\\"image\\":[\\"https://azrng.gitee.io/kbms/kbms/common/1620829882545-2591e49c-b0b0-4edf-850f-62a44d8af05f.png\\"],\\"datePublished\\":\\"2023-08-04T00:00:00.000Z\\",\\"dateModified\\":\\"2023-10-25T13:23:37.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"azrng\\"}]}"]]},"headers":[{"level":2,"title":"介绍","slug":"介绍","link":"#介绍","children":[]},{"level":2,"title":"引用组件包","slug":"引用组件包","link":"#引用组件包","children":[{"level":3,"title":"简单使用","slug":"简单使用","link":"#简单使用","children":[{"level":4,"title":"配置文件","slug":"配置文件","link":"#配置文件","children":[]},{"level":4,"title":"注入容器","slug":"注入容器","link":"#注入容器","children":[]},{"level":4,"title":"控制器使用","slug":"控制器使用","link":"#控制器使用","children":[]},{"level":4,"title":"对整个控制器or单个action控制","slug":"对整个控制器or单个action控制","link":"#对整个控制器or单个action控制","children":[]}]},{"level":3,"title":"通过时间模式控制","slug":"通过时间模式控制","link":"#通过时间模式控制","children":[{"level":4,"title":"配置文件","slug":"配置文件-1","link":"#配置文件-1","children":[]},{"level":4,"title":"注入容器","slug":"注入容器-1","link":"#注入容器-1","children":[]},{"level":4,"title":"控制器使用","slug":"控制器使用-1","link":"#控制器使用-1","children":[]},{"level":4,"title":"对整个控制器or单个action控制","slug":"对整个控制器or单个action控制-1","link":"#对整个控制器or单个action控制-1","children":[]}]}]},{"level":2,"title":"参考文档","slug":"参考文档","link":"#参考文档","children":[]}],"git":{"createdTime":1697962303000,"updatedTime":1698240217000,"contributors":[{"name":"azrng","email":"itzhangyunpeng@163.com","commits":1}]},"readingTime":{"minutes":1.46,"words":439},"filePathRelative":"dotnet/base/peizhikuangjia/peizhikaiguan/featuremanagement.md","localizedDate":"2023年8月4日","excerpt":"<h2>介绍</h2>\\n<p>通过一些简单的配置文件配置来决定某一个功能是否开启，方便快捷。</p>\\n<blockquote>\\n<p>示例环境：vs2019、net5</p>\\n</blockquote>\\n<h2>引用组件包</h2>\\n<blockquote>\\n<p>Microsoft.FeatureManagement.AspNetCore</p>\\n</blockquote>\\n<h3>简单使用</h3>\\n<h4>配置文件</h4>\\n<div class=\\"language-csharp\\" data-ext=\\"cs\\" data-title=\\"cs\\"><pre class=\\"language-csharp\\"><code><span class=\\"token punctuation\\">{</span>\\n  <span class=\\"token string\\">\\"Logging\\"</span><span class=\\"token punctuation\\">:</span> <span class=\\"token punctuation\\">{</span>\\n    <span class=\\"token string\\">\\"LogLevel\\"</span><span class=\\"token punctuation\\">:</span> <span class=\\"token punctuation\\">{</span>\\n      <span class=\\"token string\\">\\"Default\\"</span><span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"Information\\"</span><span class=\\"token punctuation\\">,</span>\\n      <span class=\\"token string\\">\\"Microsoft\\"</span><span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"Warning\\"</span><span class=\\"token punctuation\\">,</span>\\n      <span class=\\"token string\\">\\"Microsoft.Hosting.Lifetime\\"</span><span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"Information\\"</span>\\n    <span class=\\"token punctuation\\">}</span>\\n  <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">,</span>\\n  <span class=\\"token string\\">\\"FeatureManagement\\"</span><span class=\\"token punctuation\\">:</span> <span class=\\"token punctuation\\">{</span>\\n    <span class=\\"token string\\">\\"ActiveStatus\\"</span><span class=\\"token punctuation\\">:</span> <span class=\\"token boolean\\">true</span>\\n  <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">,</span>\\n  <span class=\\"token string\\">\\"AllowedHosts\\"</span><span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"*\\"</span>\\n<span class=\\"token punctuation\\">}</span>\\n\\n</code></pre></div>","autoDesc":true}');export{h as comp,f as data};
