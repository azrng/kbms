import{_ as p}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as o,o as c,c as l,a as n,d as s,e as t,b as e}from"./app-DMmdIwn0.js";const i="/kbms/common/1619445707290-24896cd8-84f8-4c04-b00d-7d9905838b1b.png",u="/kbms/common/1619445176401-398ea423-08a6-4538-b4c9-7a588b8e03be.png",k={},r=n("h2",{id:"_1-介绍",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_1-介绍"},[n("span",null,"1. 介绍")])],-1),d=n("p",null,[s("在开发AspNet Core应用的时候，我们经常会为该应用公布一个特殊的"),n("strong",null,"检测接口"),s("出来。该接口的目的很简单，告诉外界程序当前程序现在是可以访问或者不能访问的，便于外界做出相应的操作，比如监控报警，页面通知用户稍作等待等。")],-1),v={href:"https://learn.microsoft.com/zh-cn/aspnet/core/host-and-deploy/health-checks?view=aspnetcore-8.0",target:"_blank",rel:"noopener noreferrer"},m=e(`<h2 id="_2-官方包使用" tabindex="-1"><a class="header-anchor" href="#_2-官方包使用"><span>2. 官方包使用</span></a></h2><h3 id="_2-1-基本使用" tabindex="-1"><a class="header-anchor" href="#_2-1-基本使用"><span>2.1 基本使用</span></a></h3><p>ConfigureServices中注入AddHealthChecks</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	services<span class="token punctuation">.</span><span class="token function">AddControllers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	services<span class="token punctuation">.</span><span class="token function">AddHealthChecks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//或者通过安装其它nuget包实现下面方法</span>
    services<span class="token punctuation">.</span><span class="token function">AddHealthChecks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">AddSqlServer</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启用中间件MapHealthChecks</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IApplicationBuilder</span> app<span class="token punctuation">,</span> <span class="token class-name">IWebHostEnvironment</span> env<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">IsDevelopment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		app<span class="token punctuation">.</span><span class="token function">UseDeveloperExceptionPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	app<span class="token punctuation">.</span><span class="token function">UseRouting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	app<span class="token punctuation">.</span><span class="token function">UseAuthorization</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	app<span class="token punctuation">.</span><span class="token function">UseEndpoints</span><span class="token punctuation">(</span>endpoints <span class="token operator">=&gt;</span>
	<span class="token punctuation">{</span>
		endpoints<span class="token punctuation">.</span><span class="token function">MapControllers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token preprocessor property">## 通过访问地址加/health 进行访问</span>
		endpoints<span class="token punctuation">.</span><span class="token function">MapHealthChecks</span><span class="token punctuation">(</span><span class="token string">&quot;/health&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后通过访问地址：localhost:5000/health 来检查此服务是否可以使用。</p><h3 id="_2-2-目的性检查-自定义" tabindex="-1"><a class="header-anchor" href="#_2-2-目的性检查-自定义"><span>2.2 目的性检查(自定义)</span></a></h3><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// mysql健康检查</span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySQLHealthCheck</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IHealthCheck</span></span>
<span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>HealthCheckResult<span class="token punctuation">&gt;</span></span> <span class="token function">CheckHealthAsync</span><span class="token punctuation">(</span><span class="token class-name">HealthCheckContext</span> context<span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">try</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">FromResult</span><span class="token punctuation">(</span>HealthCheckResult<span class="token punctuation">.</span><span class="token function">Healthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ConfigureAwait</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">catch</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">FromResult</span><span class="token punctuation">(</span>HealthCheckResult<span class="token punctuation">.</span><span class="token function">Unhealthy</span><span class="token punctuation">(</span><span class="token string">&quot;From Sql Serve&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ConfigureAwait</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// redis健康检查</span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisHealthCheck</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IHealthCheck</span></span>
<span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>HealthCheckResult<span class="token punctuation">&gt;</span></span> <span class="token function">CheckHealthAsync</span><span class="token punctuation">(</span><span class="token class-name">HealthCheckContext</span> context<span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> Task<span class="token punctuation">.</span><span class="token function">FromResult</span><span class="token punctuation">(</span>HealthCheckResult<span class="token punctuation">.</span><span class="token function">Healthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注入</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	services<span class="token punctuation">.</span><span class="token function">AddControllers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">//只有当所有的检查器都返回为Healthy的时候，才会认为是健康。</span>
	services<span class="token punctuation">.</span><span class="token function">AddHealthChecks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddCheck</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MySQLHealthCheck<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;mysql_check&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddCheck</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>RedisHealthCheck<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;redis_check&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Configure方法不需要操作，默认配置是当检查器都返回健康时候才认为是健康。</p></blockquote><p>单个检查，有时候我们又想进行单个检查，那就需要在 <code>endpoints</code> 的配置中新增另外的路由映射规则:</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IApplicationBuilder</span> app<span class="token punctuation">,</span> <span class="token class-name">IWebHostEnvironment</span> env<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">IsDevelopment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		app<span class="token punctuation">.</span><span class="token function">UseDeveloperExceptionPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		app<span class="token punctuation">.</span><span class="token function">UseSwagger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		app<span class="token punctuation">.</span><span class="token function">UseSwaggerUI</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span><span class="token function">SwaggerEndpoint</span><span class="token punctuation">(</span><span class="token string">&quot;/swagger/v1/swagger.json&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WebApplication7 v1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	app<span class="token punctuation">.</span><span class="token function">UseRouting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	app<span class="token punctuation">.</span><span class="token function">UseAuthorization</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	app<span class="token punctuation">.</span><span class="token function">UseEndpoints</span><span class="token punctuation">(</span>endpoints <span class="token operator">=&gt;</span>
	<span class="token punctuation">{</span>
		endpoints<span class="token punctuation">.</span><span class="token function">MapControllers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		endpoints<span class="token punctuation">.</span><span class="token function">MapHealthChecks</span><span class="token punctuation">(</span><span class="token string">&quot;/mysqlhealth&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HealthCheckOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//mysql</span>
			Predicate <span class="token operator">=</span> s <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">&quot;mysql_check&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			ResponseWriter <span class="token operator">=</span> WriteResponse
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		endpoints<span class="token punctuation">.</span><span class="token function">MapHealthChecks</span><span class="token punctuation">(</span><span class="token string">&quot;/redishealth&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HealthCheckOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//redis</span>
		<span class="token punctuation">{</span>
			Predicate <span class="token operator">=</span> s <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">&quot;redis_check&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			ResponseWriter <span class="token operator">=</span> WriteResponse
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// 返回指定格式</span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>context<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>result<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>returns</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>returns</span><span class="token punctuation">&gt;</span></span></span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name">Task</span> <span class="token function">WriteResponse</span><span class="token punctuation">(</span><span class="token class-name">HttpContext</span> context<span class="token punctuation">,</span> <span class="token class-name">HealthReport</span> result<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	context<span class="token punctuation">.</span>Response<span class="token punctuation">.</span>ContentType <span class="token operator">=</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">;</span>

	<span class="token class-name"><span class="token keyword">var</span></span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">JObject</span><span class="token punctuation">(</span>
		<span class="token keyword">new</span> <span class="token constructor-invocation class-name">JProperty</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>Status<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token keyword">new</span> <span class="token constructor-invocation class-name">JProperty</span><span class="token punctuation">(</span><span class="token string">&quot;results&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">JObject</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>Entries<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>pair <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">JProperty</span><span class="token punctuation">(</span>pair<span class="token punctuation">.</span>Key<span class="token punctuation">,</span>
			<span class="token keyword">new</span> <span class="token constructor-invocation class-name">JObject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">JProperty</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span> pair<span class="token punctuation">.</span>Value<span class="token punctuation">.</span>Status<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token keyword">new</span> <span class="token constructor-invocation class-name">JProperty</span><span class="token punctuation">(</span><span class="token string">&quot;description&quot;</span><span class="token punctuation">,</span> pair<span class="token punctuation">.</span>Value<span class="token punctuation">.</span>Description<span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token keyword">new</span> <span class="token constructor-invocation class-name">JProperty</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">JObject</span><span class="token punctuation">(</span>pair<span class="token punctuation">.</span>Value<span class="token punctuation">.</span>Data<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>
					p <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">JProperty</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> p<span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> context<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteAsync</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,14),h={href:"http://localhost:5000/redishealth",target:"_blank",rel:"noopener noreferrer"},g={href:"http://localhost:5000/redishealth",target:"_blank",rel:"noopener noreferrer"},b=e('<figure><img src="'+i+`" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="_2-3-常见的健康检查" tabindex="-1"><a class="header-anchor" href="#_2-3-常见的健康检查"><span>2.3 常见的健康检查</span></a></h3><p>MongoDB</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token comment">//包引用：Install-Package AspNetCore.HealthChecks.MongoDb -Version 6.0.2</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IServiceCollection</span> <span class="token function">AddCustomHealthCheck</span><span class="token punctuation">(</span>
  <span class="token keyword">this</span> <span class="token class-name">IServiceCollection</span> services<span class="token punctuation">,</span>
  <span class="token class-name">IConfiguration</span> configuration<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> hcBuilder <span class="token operator">=</span> services<span class="token punctuation">.</span><span class="token function">AddHealthChecks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hcBuilder<span class="token punctuation">.</span><span class="token function">AddCheck</span><span class="token punctuation">(</span><span class="token string">&quot;self&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> HealthCheckResult<span class="token punctuation">.</span><span class="token function">Healthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">AddMongoDb</span><span class="token punctuation">(</span>
            configuration<span class="token punctuation">[</span><span class="token string">&quot;ConnectionString&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token named-parameter punctuation">name</span><span class="token punctuation">:</span> <span class="token string">&quot;CouponCollection-check&quot;</span><span class="token punctuation">,</span>
            <span class="token named-parameter punctuation">tags</span><span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> <span class="token string">&quot;couponcollection&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="aspnetcore-healthchecks" tabindex="-1"><a class="header-anchor" href="#aspnetcore-healthchecks"><span>AspNetCore.HealthChecks</span></a></h2><h3 id="_3-1-介绍" tabindex="-1"><a class="header-anchor" href="#_3-1-介绍"><span>3.1 介绍</span></a></h3><p>是一个用于.NetCore健康检查的包，支持的版本有：5.0，3.1，3.0，2.2</p>`,7),C={href:"https://github.com/xabaril/AspNetCore.Diagnostics.HealthChecks",target:"_blank",rel:"noopener noreferrer"},q=e(`<p>支持一一些封装的检查</p><ul><li>Sql Server</li><li>MySql</li><li>Oracle</li><li>Sqlite</li><li>RavenDB</li><li>Postgres</li><li>EventStore</li><li>RabbitMQ</li><li>IbmMQ</li><li>Elasticsearch</li><li>CosmosDb</li><li>Solr</li><li>Redis</li><li>SendGrid</li><li>System: Disk Storage, Private Memory, Virtual Memory, Process, Windows Service</li><li>Azure Service Bus: EventHub, Queue and Topics</li><li>Azure Storage: Blob, Queue and Table</li><li>Azure Key Vault</li><li>Azure DocumentDb</li><li>Azure IoT Hub</li><li>Amazon DynamoDb</li><li>Amazon S3</li><li>Google Cloud Firestore</li><li>Network: Ftp, SFtp, Dns, Tcp port, Smtp, Imap, Ssl</li><li>MongoDB</li><li>Kafka</li><li>Identity Server</li><li>Uri: single uri and uri groups</li><li>Consul</li><li>Hangfire</li><li>SignalR</li><li>Kubernetes</li><li>ArangoDB</li><li>Gremlin</li></ul><p>对应的Nuget包为</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>System
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Network
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>SqlServer
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>MongoDb
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Npgsql
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Elasticsearch
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>CosmosDb
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Solr
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Redis
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>EventStore
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>AzureStorage
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>AzureServiceBus
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>AzureKeyVault
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Azure<span class="token punctuation">.</span>IoTHub
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>MySql
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>DocumentDb
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>SqLite
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>RavenDB
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Kafka
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>RabbitMQ
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>IbmMQ
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>OpenIdConnectServer
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>DynamoDB
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Oracle
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Uris
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Aws<span class="token punctuation">.</span>S3
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Consul
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Hangfire
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>SignalR
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Kubernetes
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Gcp<span class="token punctuation">.</span>CloudFirestore
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>SendGrid
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>ArangoDb
Install<span class="token operator">-</span>Package AspNetCore<span class="token punctuation">.</span>HealthChecks<span class="token punctuation">.</span>Gremlin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-基本使用" tabindex="-1"><a class="header-anchor" href="#_3-2-基本使用"><span>3.2 基本使用</span></a></h3><p>本次事例来演示一个带UI界面的健康监控的基本使用，需要以下nuget包</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code>    <span class="token operator">&lt;</span><span class="token class-name">PackageReference</span> Include<span class="token operator">=</span><span class="token string">&quot;AspNetCore.HealthChecks.UI&quot;</span> Version<span class="token operator">=</span><span class="token string">&quot;5.0.1&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token class-name">PackageReference</span> Include<span class="token operator">=</span><span class="token string">&quot;AspNetCore.HealthChecks.UI.Client&quot;</span> Version<span class="token operator">=</span><span class="token string">&quot;5.0.1&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token class-name">PackageReference</span> Include<span class="token operator">=</span><span class="token string">&quot;AspNetCore.HealthChecks.UI.InMemory.Storage&quot;</span> Version<span class="token operator">=</span><span class="token string">&quot;5.0.1&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>部分代码使用上述的例子 注入</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	services<span class="token punctuation">.</span><span class="token function">AddControllers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	services<span class="token punctuation">.</span><span class="token function">AddHealthChecks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddCheck</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MySQLHealthCheck<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;mysql_check&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddCheck</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>RedisHealthCheck<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;redis_check&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	services<span class="token punctuation">.</span><span class="token function">AddHealthChecksUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">AddInMemoryStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IApplicationBuilder</span> app<span class="token punctuation">,</span> <span class="token class-name">IWebHostEnvironment</span> env<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">IsDevelopment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		app<span class="token punctuation">.</span><span class="token function">UseDeveloperExceptionPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	app<span class="token punctuation">.</span><span class="token function">UseRouting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	app<span class="token punctuation">.</span><span class="token function">UseAuthorization</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	app<span class="token punctuation">.</span><span class="token function">UseEndpoints</span><span class="token punctuation">(</span>endpoints <span class="token operator">=&gt;</span>
	<span class="token punctuation">{</span>
		endpoints<span class="token punctuation">.</span><span class="token function">MapControllers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		endpoints<span class="token punctuation">.</span><span class="token function">MapHealthChecks</span><span class="token punctuation">(</span><span class="token string">&quot;/mysqlhealth&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HealthCheckOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			Predicate <span class="token operator">=</span> s <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">&quot;mysql_check&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			ResponseWriter <span class="token operator">=</span> UIResponseWriter<span class="token punctuation">.</span>WriteHealthCheckUIResponse
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		endpoints<span class="token punctuation">.</span><span class="token function">MapHealthChecks</span><span class="token punctuation">(</span><span class="token string">&quot;/redishealth&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HealthCheckOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			Predicate <span class="token operator">=</span> s <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">&quot;redis_check&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			ResponseWriter <span class="token operator">=</span> UIResponseWriter<span class="token punctuation">.</span>WriteHealthCheckUIResponse
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		endpoints<span class="token punctuation">.</span><span class="token function">MapHealthChecksUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置文件</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;Logging&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;LogLevel&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;Default&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Information&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;Microsoft&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Warning&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;Microsoft.Hosting.Lifetime&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Information&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;HealthChecksUI&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;HealthChecks&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;Name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;HTTP-Api-mysqlhealth&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Uri&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;/mysqlhealth&quot;</span><span class="token comment">//新版本可以使用相对路径</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;Name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;HTTP-Api-redishealth&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Uri&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;/redishealth&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Webhooks&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;Name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Uri&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Payload&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;RestoredPayload&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;EvaluationTimeInSeconds&quot;</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token comment">//轮询间隔</span>
    <span class="token string">&quot;MinimumSecondsBetweenFailureNotifications&quot;</span><span class="token punctuation">:</span> <span class="token number">60</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;AllowedHosts&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动程序访问：/healthchecks-ui 地址 <img src="`+u+'" alt="image.png" loading="lazy"> 通过该UI界面可以直观查看哪些监控服务出现问题</p><h2 id="_4-参考文档" tabindex="-1"><a class="header-anchor" href="#_4-参考文档"><span>4. 参考文档</span></a></h2>',15),y={href:"https://blog.csdn.net/uoyo_blog/article/details/104811948/",target:"_blank",rel:"noopener noreferrer"};function f(H,A){const a=o("ExternalLinkIcon");return c(),l("div",null,[r,d,n("p",null,[s("官网文档："),n("a",v,[s("此处"),t(a)])]),m,n("blockquote",null,[n("p",null,[s("通过访问地址："),n("a",h,[s("http://localhost:5000/mysqlhealth"),t(a)]),s(" 查看mysql连接状态 通过访问地址："),n("a",g,[s("http://localhost:5000/redishealth"),t(a)]),s(" 查看redis连接状态")])]),b,n("blockquote",null,[n("p",null,[s("GitHub："),n("a",C,[s("https://github.com/xabaril/AspNetCore.Diagnostics.HealthChecks"),t(a)])])]),q,n("blockquote",null,[n("p",null,[s("AspNetCore的HealthCheck ："),n("a",y,[s("https://blog.csdn.net/uoyo_blog/article/details/104811948/"),t(a)])])])])}const I=p(k,[["render",f],["__file","jiankangjiancha.html.vue"]]),N=JSON.parse('{"path":"/dotnet/base/jiankangjiancha/jiankangjiancha.html","title":"健康检查","lang":"zh-CN","frontmatter":{"title":"健康检查","lang":"zh-CN","date":"2023-05-29T00:00:00.000Z","publish":true,"author":"azrng","isOriginal":true,"category":["dotNET"],"tag":["无"],"filename":"jiankangjiancha","slug":"beckhl","docsId":"44014874","description":"1. 介绍 在开发AspNet Core应用的时候，我们经常会为该应用公布一个特殊的检测接口出来。该接口的目的很简单，告诉外界程序当前程序现在是可以访问或者不能访问的，便于外界做出相应的操作，比如监控报警，页面通知用户稍作等待等。 官网文档：此处 2. 官方包使用 2.1 基本使用 ConfigureServices中注入AddHealthChecks...","head":[["meta",{"property":"og:url","content":"https://azrng.gitee.io/kbms/kbms/dotnet/base/jiankangjiancha/jiankangjiancha.html"}],["meta",{"property":"og:site_name","content":"知识库"}],["meta",{"property":"og:title","content":"健康检查"}],["meta",{"property":"og:description","content":"1. 介绍 在开发AspNet Core应用的时候，我们经常会为该应用公布一个特殊的检测接口出来。该接口的目的很简单，告诉外界程序当前程序现在是可以访问或者不能访问的，便于外界做出相应的操作，比如监控报警，页面通知用户稍作等待等。 官网文档：此处 2. 官方包使用 2.1 基本使用 ConfigureServices中注入AddHealthChecks..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://azrng.gitee.io/kbms/kbms/common/1619445707290-24896cd8-84f8-4c04-b00d-7d9905838b1b.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-26T12:04:07.000Z"}],["meta",{"property":"article:author","content":"azrng"}],["meta",{"property":"article:tag","content":"无"}],["meta",{"property":"article:published_time","content":"2023-05-29T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-03-26T12:04:07.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"健康检查\\",\\"image\\":[\\"https://azrng.gitee.io/kbms/kbms/common/1619445707290-24896cd8-84f8-4c04-b00d-7d9905838b1b.png\\",\\"https://azrng.gitee.io/kbms/kbms/common/1619445176401-398ea423-08a6-4538-b4c9-7a588b8e03be.png\\"],\\"datePublished\\":\\"2023-05-29T00:00:00.000Z\\",\\"dateModified\\":\\"2024-03-26T12:04:07.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"azrng\\"}]}"]]},"headers":[{"level":2,"title":"1. 介绍","slug":"_1-介绍","link":"#_1-介绍","children":[]},{"level":2,"title":"2. 官方包使用","slug":"_2-官方包使用","link":"#_2-官方包使用","children":[{"level":3,"title":"2.1 基本使用","slug":"_2-1-基本使用","link":"#_2-1-基本使用","children":[]},{"level":3,"title":"2.2 目的性检查(自定义)","slug":"_2-2-目的性检查-自定义","link":"#_2-2-目的性检查-自定义","children":[]},{"level":3,"title":"2.3 常见的健康检查","slug":"_2-3-常见的健康检查","link":"#_2-3-常见的健康检查","children":[]}]},{"level":2,"title":"AspNetCore.HealthChecks","slug":"aspnetcore-healthchecks","link":"#aspnetcore-healthchecks","children":[{"level":3,"title":"3.1 介绍","slug":"_3-1-介绍","link":"#_3-1-介绍","children":[]},{"level":3,"title":"3.2 基本使用","slug":"_3-2-基本使用","link":"#_3-2-基本使用","children":[]}]},{"level":2,"title":"4. 参考文档","slug":"_4-参考文档","link":"#_4-参考文档","children":[]}],"git":{"createdTime":1697962303000,"updatedTime":1711454647000,"contributors":[{"name":"azrng","email":"itzhangyunpeng@163.com","commits":1},{"name":"zhangyunpeng","email":"zhang.yunpeng@synyi.com","commits":1}]},"readingTime":{"minutes":3.63,"words":1090},"filePathRelative":"dotnet/base/jiankangjiancha/jiankangjiancha.md","localizedDate":"2023年5月29日","excerpt":"<h2>1. 介绍</h2>\\n<p>在开发AspNet Core应用的时候，我们经常会为该应用公布一个特殊的<strong>检测接口</strong>出来。该接口的目的很简单，告诉外界程序当前程序现在是可以访问或者不能访问的，便于外界做出相应的操作，比如监控报警，页面通知用户稍作等待等。</p>\\n<p>官网文档：<a href=\\"https://learn.microsoft.com/zh-cn/aspnet/core/host-and-deploy/health-checks?view=aspnetcore-8.0\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">此处</a></p>","autoDesc":true}');export{I as comp,N as data};
