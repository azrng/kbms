import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,o as a,d as e}from"./app-41nmD-Ik.js";const t={},n=e(`<h2 id="命令行创建本地布局" tabindex="-1"><a class="header-anchor" href="#命令行创建本地布局"><span>命令行创建本地布局</span></a></h2><p>下载所需 Visual Studio 版本的引导程序，并将其复制到要用作本地布局源位置的目录中。 创建布局后，可以使用它安装 Visual Studio。 引导程序是用于创建、更新和执行其他 Visual Stusio 安装操作的可执行文件。 必须建立 Internet 连接才能完成此操作。</p><h3 id="下载引导程序" tabindex="-1"><a class="header-anchor" href="#下载引导程序"><span>下载引导程序</span></a></h3><table><thead><tr><th>版本</th><th>引导程序</th></tr></thead><tbody><tr><td>Visual Studio 2022 Community</td><td><a href="https://aka.ms/vs/17/release/vs_community.exe" target="_blank" rel="noopener noreferrer">vs_community.exe</a></td></tr><tr><td>Visual Studio 2022 Professional</td><td><a href="https://aka.ms/vs/17/release/vs_professional.exe" target="_blank" rel="noopener noreferrer">vs_professional.exe</a></td></tr><tr><td>Visual Studio 2022 Enterprise</td><td><a href="https://aka.ms/vs/17/release/vs_enterprise.exe" target="_blank" rel="noopener noreferrer">vs_enterprise.exe</a></td></tr><tr><td>Visual Studio 2022 生成工具</td><td><a href="https://aka.ms/vs/17/release/vs_buildtools.exe" target="_blank" rel="noopener noreferrer">vs_buildtools.exe</a></td></tr></tbody></table><h3 id="创建本地布局" tabindex="-1"><a class="header-anchor" href="#创建本地布局"><span>创建本地布局</span></a></h3><p>使用管理员权限打开命令提示符，导航到下载引导程序到的目录，并使用 <a href="https://docs.microsoft.com/zh-cn/visualstudio/install/use-command-line-parameters-to-install-visual-studio?view=vs-2022" target="_blank" rel="noopener noreferrer">“使用命令行参数”</a> 中定义的引导程序参数来安装 Visual Studio 页面以创建本地布局。</p><p>对于.Net Web和.Net桌面开发，运行</p><div class="language-csharp line-numbers-mode" data-highlighter="shiki" data-ext="csharp" data-title="csharp" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">vs_enterprise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">exe</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> --</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">layout</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E06C75;"> D</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">Download</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">vs2022</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">localVSlayout</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> --</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Microsoft</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">VisualStudio</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Workload</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">ManagedDesktop</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> --</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Microsoft</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">VisualStudio</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Workload</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">NetWeb</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> --</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">includeOptional</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> --</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">lang</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> zh</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">CN</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>要创建完整的本地布局，需要使用（仅限英语，所有功能）</p><div class="language-csharp line-numbers-mode" data-highlighter="shiki" data-ext="csharp" data-title="csharp" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">vs_enterprise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">exe</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> --</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">layout</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E06C75;"> D</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">Download</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">vs2022</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">localVSlayoutt</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> --</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">lang</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> en</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">US</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>Visual Studio 的完整本地布局至少需要 45 GB 的磁盘空间</p></blockquote><h3 id="通过vsconfig文件安装" tabindex="-1"><a class="header-anchor" href="#通过vsconfig文件安装"><span>通过VsConfig文件安装</span></a></h3><p><a href="https://learn.microsoft.com/zh-cn/visualstudio/install/create-a-network-installation-of-visual-studio?view=vs-2022#use-a-configuration-file-to-initialize-the-contents-of-a-layout" target="_blank" rel="noopener noreferrer">使用配置文件初始化布局的内容</a></p><p><a href="https://learn.microsoft.com/zh-cn/visualstudio/install/import-export-installation-configurations?view=vs-2022#extensions" target="_blank" rel="noopener noreferrer">导出扩展布局</a></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">vs_enterprise.exe</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --layout</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> E:</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\L</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ocalVs2022</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --lang</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Zh-cn</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --config</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;e:\\2022.vsconfig&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="本地布局安装" tabindex="-1"><a class="header-anchor" href="#本地布局安装"><span>本地布局安装</span></a></h2><p>从本地布局安装 Visual Studio 时，Visual Studio 安装程序使用文件的本地版本。 但是，如果在安装期间选择不在布局中的组件，Visual Studio 安装程序将尝试从 Internet 下载它们，安装命令</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">--</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 示例命令</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">vs_enterprise.exe</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --layout</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c:</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\l</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ocalVSlayout</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Microsoft.VisualStudio.Workload.ManagedDesktop</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Microsoft.VisualStudio.Workload.NetWeb</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --includeOptional</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --lang</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Zh-cn</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>使用下面命令的话就可以安装并阻止该访问Internet</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">--</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 示例命令</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">c:\\localVSlayout\\vs_enterprise.exe</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --noWeb</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Microsoft.VisualStudio.Workload.ManagedDesktop</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Microsoft.VisualStudio.Workload.NetWeb</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --includeOptional</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">D:\\Download\\vs2022\\localVSlayoutt\\vs_enterprise.exe</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --noweb</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Microsoft.VisualStudio.Workload.ManagedDesktop</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Microsoft.VisualStudio.Workload.NetWeb</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --includeOptional</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果之前使用的vsconfig进行的下载，那么安装的时候也使用该命令行安装</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">--</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 在本地布局文件的目录下执行命令</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">vs_enterprise.exe</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --noweb</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --config</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;2022.vsconfig&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>注意： 如果使用的是 Visual Studio Community，则必须在安装后的 30 天内登录产品以激活它。 激活需要 Internet 连接。 如果你遇到签名无效的错误，则必须<a href="https://docs.microsoft.com/zh-cn/visualstudio/install/install-certificates-for-visual-studio-offline?view=vs-2022" target="_blank" rel="noopener noreferrer">安装更新的证书</a>。 在本地布局中打开“证书”文件夹。 双击每个证书文件，然后单击完成证书管理器向导。 如果要求输入密码，请将密码留空。</p></blockquote><h2 id="资料" tabindex="-1"><a class="header-anchor" href="#资料"><span>资料</span></a></h2><p>官方文档：<a href="https://docs.microsoft.com/zh-cn/visualstudio/install/create-an-offline-installation-of-visual-studio?view=vs-2022" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/zh-cn/visualstudio/install/create-an-offline-installation-of-visual-studio?view=vs-2022</a></p>`,25),l=[n];function h(r,k){return a(),s("div",null,l)}const o=i(t,[["render",h],["__file","offLineInstall.html.vue"]]),g=JSON.parse('{"path":"/soft/devTools/VisualStudio/offLineInstall.html","title":"离线版本安装教程","lang":"zh-CN","frontmatter":{"title":"离线版本安装教程","lang":"zh-CN","date":"2023-07-22T00:00:00.000Z","publish":true,"author":"azrng","order":"008","category":["Visual Studio"],"tag":["无"],"filename":"offLineInstall","description":"命令行创建本地布局 下载所需 Visual Studio 版本的引导程序，并将其复制到要用作本地布局源位置的目录中。 创建布局后，可以使用它安装 Visual Studio。 引导程序是用于创建、更新和执行其他 Visual Stusio 安装操作的可执行文件。 必须建立 Internet 连接才能完成此操作。 下载引导程序 创建本地布局 使用管理员权...","head":[["meta",{"property":"og:url","content":"https://azrng.gitee.io/kbms/kbms/soft/devTools/VisualStudio/offLineInstall.html"}],["meta",{"property":"og:site_name","content":"知识库"}],["meta",{"property":"og:title","content":"离线版本安装教程"}],["meta",{"property":"og:description","content":"命令行创建本地布局 下载所需 Visual Studio 版本的引导程序，并将其复制到要用作本地布局源位置的目录中。 创建布局后，可以使用它安装 Visual Studio。 引导程序是用于创建、更新和执行其他 Visual Stusio 安装操作的可执行文件。 必须建立 Internet 连接才能完成此操作。 下载引导程序 创建本地布局 使用管理员权..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-07-06T03:31:29.000Z"}],["meta",{"property":"article:author","content":"azrng"}],["meta",{"property":"article:tag","content":"无"}],["meta",{"property":"article:published_time","content":"2023-07-22T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-07-06T03:31:29.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"离线版本安装教程\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-07-22T00:00:00.000Z\\",\\"dateModified\\":\\"2024-07-06T03:31:29.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"azrng\\"}]}"]]},"headers":[{"level":2,"title":"命令行创建本地布局","slug":"命令行创建本地布局","link":"#命令行创建本地布局","children":[{"level":3,"title":"下载引导程序","slug":"下载引导程序","link":"#下载引导程序","children":[]},{"level":3,"title":"创建本地布局","slug":"创建本地布局","link":"#创建本地布局","children":[]},{"level":3,"title":"通过VsConfig文件安装","slug":"通过vsconfig文件安装","link":"#通过vsconfig文件安装","children":[]}]},{"level":2,"title":"本地布局安装","slug":"本地布局安装","link":"#本地布局安装","children":[]},{"level":2,"title":"资料","slug":"资料","link":"#资料","children":[]}],"git":{"createdTime":1690010917000,"updatedTime":1720236689000,"contributors":[{"name":"azrng","email":"itzhangyunpeng@163.com","commits":2}]},"readingTime":{"minutes":2.44,"words":731},"filePathRelative":"soft/devTools/VisualStudio/offLineInstall.md","localizedDate":"2023年7月22日","excerpt":"<h2>命令行创建本地布局</h2>\\n<p>下载所需 Visual Studio 版本的引导程序，并将其复制到要用作本地布局源位置的目录中。 创建布局后，可以使用它安装 Visual Studio。 引导程序是用于创建、更新和执行其他 Visual Stusio 安装操作的可执行文件。 必须建立 Internet 连接才能完成此操作。</p>\\n<h3>下载引导程序</h3>\\n<table>\\n<thead>\\n<tr>\\n<th>版本</th>\\n<th>引导程序</th>\\n</tr>\\n</thead>\\n<tbody>\\n<tr>\\n<td>Visual Studio 2022 Community</td>\\n<td><a href=\\"https://aka.ms/vs/17/release/vs_community.exe\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">vs_community.exe</a></td>\\n</tr>\\n<tr>\\n<td>Visual Studio 2022 Professional</td>\\n<td><a href=\\"https://aka.ms/vs/17/release/vs_professional.exe\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">vs_professional.exe</a></td>\\n</tr>\\n<tr>\\n<td>Visual Studio 2022 Enterprise</td>\\n<td><a href=\\"https://aka.ms/vs/17/release/vs_enterprise.exe\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">vs_enterprise.exe</a></td>\\n</tr>\\n<tr>\\n<td>Visual Studio 2022 生成工具</td>\\n<td><a href=\\"https://aka.ms/vs/17/release/vs_buildtools.exe\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">vs_buildtools.exe</a></td>\\n</tr>\\n</tbody>\\n</table>","autoDesc":true}');export{o as comp,g as data};
